"use strict";(self.webpackChunkotter_shell=self.webpackChunkotter_shell||[]).push([[8891],{3905:(e,a,n)=>{n.d(a,{Zo:()=>c,kt:()=>m});var r=n(67294);function o(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function t(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?t(Object(n),!0).forEach((function(a){o(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,r,o=function(e,a){if(null==e)return{};var n,r,o={},t=Object.keys(e);for(r=0;r<t.length;r++)n=t[r],a.indexOf(n)>=0||(o[n]=e[n]);return o}(e,a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(r=0;r<t.length;r++)n=t[r],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),d=function(e){var a=r.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},c=function(e){var a=d(e.components);return r.createElement(l.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},p=r.forwardRef((function(e,a){var n=e.components,o=e.mdxType,t=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=d(n),m=o,v=p["".concat(l,".").concat(m)]||p[m]||u[m]||t;return n?r.createElement(v,i(i({ref:a},c),{},{components:n})):r.createElement(v,i({ref:a},c))}));function m(e,a){var n=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var t=n.length,i=new Array(t);i[0]=p;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var d=2;d<t;d++)i[d]=n[d];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},18510:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>t,metadata:()=>s,toc:()=>d});var r=n(87462),o=(n(67294),n(3905));const t={sidebar_position:30},i="Servidores Web, Base de Datos y DNS en nuestros escenario de OpenStack",s={unversionedId:"Tasks/dns_escenario_openstack",id:"Tasks/dns_escenario_openstack",title:"Servidores Web, Base de Datos y DNS en nuestros escenario de OpenStack",description:"Procedimiento",source:"@site/docs/Tasks/dns_escenario_openstack.md",sourceDirName:"Tasks",slug:"/Tasks/dns_escenario_openstack",permalink:"/docs/Tasks/dns_escenario_openstack",draft:!1,editUrl:"https://github.com/belennazareth/ottershell/blob/main/docs/Tasks/dns_escenario_openstack.md",tags:[],version:"current",sidebarPosition:30,frontMatter:{sidebar_position:30},sidebar:"tutorialSidebar",previous:{title:"Funcionamiento del servidor DHCP",permalink:"/docs/Tasks/funcionamiento_dhcp"},next:{title:"Instalaci\xf3n de phpmyadmin",permalink:"/docs/Tasks/phpmyadmin"}},l={},d=[{value:"Procedimiento",id:"procedimiento",level:2},{value:"Servidor DNS",id:"servidor-dns",level:3},{value:"Servidor Web",id:"servidor-web",level:3},{value:"Servidor de Base de Datos",id:"servidor-de-base-de-datos",level:3},{value:"Entrega",id:"entrega",level:2},{value:"1. Entrega la configuraci\xf3n DNS de cada m\xe1quina.",id:"1-entrega-la-configuraci\xf3n-dns-de-cada-m\xe1quina",level:3},{value:"2. Entrega la definici\xf3n de las vistas y de las zonas.",id:"2-entrega-la-definici\xf3n-de-las-vistas-y-de-las-zonas",level:3},{value:"3. Entrega el resultado de las siguientes consultas desde una m\xe1quina interna a nuestra red y otro externo:",id:"3-entrega-el-resultado-de-las-siguientes-consultas-desde-una-m\xe1quina-interna-a-nuestra-red-y-otro-externo",level:3},{value:"4. Entrega una captura de pantalla accediendo a www.tunombre.gonzalonazareno.org/info.php donde se vea la salida del fichero info.php.",id:"4-entrega-una-captura-de-pantalla-accediendo-a-wwwtunombregonzalonazarenoorginfophp-donde-se-vea-la-salida-del-fichero-infophp",level:3},{value:"5. Entrega una prueba de funcionamiento donde se vea como se realiza una conexi\xf3n a la base de datos desde bravo.",id:"5-entrega-una-prueba-de-funcionamiento-donde-se-vea-como-se-realiza-una-conexi\xf3n-a-la-base-de-datos-desde-bravo",level:3}],c={toc:d};function u(e){let{components:a,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"servidores-web-base-de-datos-y-dns-en-nuestros-escenario-de-openstack"},"Servidores Web, Base de Datos y DNS en nuestros escenario de OpenStack"),(0,o.kt)("h2",{id:"procedimiento"},"Procedimiento"),(0,o.kt)("h3",{id:"servidor-dns"},"Servidor DNS"),(0,o.kt)("p",null,"Vamos a instalar un servidor dns en charlie que nos permita gestionar la resoluci\xf3n directa e inversa de nuestros nombres. Cada alumno va a poseer un servidor dns con autoridad sobre un subdominio de nuestro dominio principal ",(0,o.kt)("inlineCode",{parentName:"p"},"gonzalonazareno.org"),", que se llamar\xe1 ",(0,o.kt)("inlineCode",{parentName:"p"},"tu_nombre.gonzalonazareno.org.")),(0,o.kt)("p",null,"Hay que tener en cuenta los siguientes aspectos:"),(0,o.kt)("p",null,"1.- Modifica la configuraci\xf3n de la subred en las redes que est\xe1s usando en OpenStack para que el servidor DNS principal sea charlie (192.168.0.2). O modifica los ficheros /etc/resolv.conf de forma permanente si quieres no tocar los servidores DHCP."),(0,o.kt)("p",null,"2.- Modifica la configuraci\xf3n de los contenedores para que usen charlie como DNS."),(0,o.kt)("p",null,"3.- El servidor DNS que vamos a usar va a actuar como forward/cach\xe9, de tal manera que las consultas la realizar\xe1 sobre nuestro servidor 192.168.202.2. Para configurar el servidor como forwarder hay que modificar el par\xe1metro en el fichero named.conf.options."),(0,o.kt)("p",null,"4.- Ser\xe1 necesario realizar consultas desde el exterior (ya que vamos a hacer una delegaci\xf3n del subdominio). Determina la regla DNAT en alfa para que podamos hacer consultas DNS desde el exterior."),(0,o.kt)("p",null,"5.- Indica al profesor el nombre de tu dominio para que pueda realizar la delegaci\xf3n en el servidor DNS principal papion-dns. Recuerda que papion-dns (192.168.202.2) debe poder realizar consultas a tu servidor DNS."),(0,o.kt)("p",null,"6.- El servidor DNS se va a configurar en un principio de la siguiente manera:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"El servidor DNS se llama charlie.tu_nombre.gonzalonazareno.org y va a ser el servidor con autoridad para la zona tu_nombre.gonzalonazareno.org.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"El servidor debe resolver el nombre de todas las m\xe1quinas.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"El servidor debe resolver los distintos servicios (virtualhost, servidor de base de datos, servidor ldap, \u2026).")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Vamos a usar vistas en bind9, para que el nombre de alfa se corresponda con una ip distinta seg\xfan desde se realice la consulta.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Determina cuantas vistas vamos a crear y que nombres se van a crear en cada vista.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Vamos a crear las zonas de resoluci\xf3n inversas correspondientes al direccionamiento de las redes privadas."))),(0,o.kt)("p",null,"Primero, en ",(0,o.kt)("inlineCode",{parentName:"p"},"charlie"),", instalamos bind9:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get install bind9\n")),(0,o.kt)("p",null,"Despu\xe9s, en el fichero ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/bind/named.conf.local")," configuramos las vistas y las zonas:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'view interna {\n    match-clients { 192.168.0.0/24; 127.0.0.1; };\n    allow-recursion { any; };\n        zone "nazareth.gonzalonazareno.org" \n        {\n               type master;\n               file "db.interna.nazareth.gonzalonazareno.org";\n        };\n        zone "0.168.192.in-addr.arpa" \n        {\n               type master;\n               file "db.0.168.192";\n        };\n        zone "16.172.in-addr.arpa" \n        {\n               type master;\n               file "db.16.172";\n        };\n        include "/etc/bind/zones.rfc1918";\n        include "/etc/bind/named.conf.default-zones";\n};\n\nview externa {\n    match-clients { 172.22.0.0/16; 192.168.202.2; 172.29.0.0/16;};\n    allow-recursion { any; };\n        zone "nazareth.gonzalonazareno.org" \n        {\n               type master;\n               file "db.externa.nazareth.gonzalonazareno.org";\n        };\n        include "/etc/bind/zones.rfc1918";\n        include "/etc/bind/named.conf.default-zones";\n};\n\nview dmz {\n    match-clients { 172.16.0.0/16; };\n    allow-recursion { any; };\n        zone "nazareth.gonzalonazareno.org"\n        {\n               type master;\n               file "db.dmz.nazareth.gonzalonazareno.org";\n        };\n        zone "16.172.in-addr.arpa"\n        {\n               type master;\n               file "db.16.172";\n        };\n        zone "0.168.192.in-addr.arpa"\n        {\n               type master;\n               file "db.0.168.192";\n        };\n        include "/etc/bind/zones.rfc1918";\n        include "/etc/bind/named.conf.default-zones";\n};\n')),(0,o.kt)("p",null,"Donde, meteremos por zonas lo que va a resolver cada vista. En este caso, la vista ",(0,o.kt)("inlineCode",{parentName:"p"},"interna")," resolver\xe1 las zonas ",(0,o.kt)("inlineCode",{parentName:"p"},"nazareth.gonzalonazareno.org")," y las zonas de resoluci\xf3n inversa de las redes privadas. La vista ",(0,o.kt)("inlineCode",{parentName:"p"},"externa")," resolver\xe1 las zonas ",(0,o.kt)("inlineCode",{parentName:"p"},"nazareth.gonzalonazareno.org")," y las zonas de resoluci\xf3n inversa de las redes privadas. La vista ",(0,o.kt)("inlineCode",{parentName:"p"},"dmz")," resolver\xe1 las zonas ",(0,o.kt)("inlineCode",{parentName:"p"},"nazareth.gonzalonazareno.org")," y las zonas de resoluci\xf3n inversa de las redes privadas."),(0,o.kt)("p",null,"En el fichero ",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/bind/named.conf")," a\xf1adimos las vistas:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'include "/etc/bind/named.conf.local";\ninclude "/etc/bind/named.conf.options";\ninclude "/etc/bind/named.conf.default-zones";\n')),(0,o.kt)("p",null,"Despu\xe9s, creamos los ficheros de configuraci\xf3n de las zonas:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"touch /var/cache/bind/db.interna.nazareth.gonzalonazareno.org\ntouch /var/cache/bind/db.externa.nazareth.gonzalonazareno.org\ntouch /var/cache/bind/db.dmz.nazareth.gonzalonazareno.org\n")),(0,o.kt)("p",null,"Y, por \xfaltimo, configuramos las zonas:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"db.interna.nazareth.gonzalonazareno.org"),":")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"db.externa.nazareth.gonzalonazareno.org"),":")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"db.dmz.nazareth.gonzalonazareno.org"),":")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"")),(0,o.kt)("h3",{id:"servidor-web"},"Servidor Web"),(0,o.kt)("p",null,"En ",(0,o.kt)("inlineCode",{parentName:"p"},"bravo")," vamos a instalar un servidor web apache. Configura el servidor para que sea capaz de ejecutar c\xf3digo php. Investiga las reglas DNAT de cortafuegos que tienes que configurar en ",(0,o.kt)("inlineCode",{parentName:"p"},"alfa")," para, cuando accedamos a la IP flotante/p\xfablica se acceda al servidor web. La p\xe1gina web ser\xe1 accesible con el nombre ",(0,o.kt)("inlineCode",{parentName:"p"},"www.tu_nombre.gonzalonazareno.org.")),(0,o.kt)("h3",{id:"servidor-de-base-de-datos"},"Servidor de Base de Datos"),(0,o.kt)("p",null,"En ",(0,o.kt)("inlineCode",{parentName:"p"},"delta")," vamos a instalar un servidor de base de datos mariadb (",(0,o.kt)("inlineCode",{parentName:"p"},"bd.tu_nombre.gonzalonazareno.org"),"). A este servidor de base de datos se debe permitir el acceso desde todas las m\xe1quinas del escenario."),(0,o.kt)("h2",{id:"entrega"},"Entrega"),(0,o.kt)("h3",{id:"1-entrega-la-configuraci\xf3n-dns-de-cada-m\xe1quina"},"1. Entrega la configuraci\xf3n DNS de cada m\xe1quina."),(0,o.kt)("h3",{id:"2-entrega-la-definici\xf3n-de-las-vistas-y-de-las-zonas"},"2. Entrega la definici\xf3n de las vistas y de las zonas."),(0,o.kt)("h3",{id:"3-entrega-el-resultado-de-las-siguientes-consultas-desde-una-m\xe1quina-interna-a-nuestra-red-y-otro-externo"},"3. Entrega el resultado de las siguientes consultas desde una m\xe1quina interna a nuestra red y otro externo:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"El servidor DNS con autoridad sobre la zona del dominio tu_nombre.gonzalonazareno.org.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"La direcci\xf3n IP de alfa.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Una resoluci\xf3n de www.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Una resoluci\xf3n de bd.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Un resoluci\xf3n inversa de IP fija en cada una de las redes. (Esta consulta s\xf3lo funcionar\xe1 desde una m\xe1quina interna)."))),(0,o.kt)("h3",{id:"4-entrega-una-captura-de-pantalla-accediendo-a-wwwtunombregonzalonazarenoorginfophp-donde-se-vea-la-salida-del-fichero-infophp"},"4. Entrega una captura de pantalla accediendo a ",(0,o.kt)("a",{parentName:"h3",href:"http://www.tunombre.gonzalonazareno.org/info.php"},"www.tunombre.gonzalonazareno.org/info.php")," donde se vea la salida del fichero info.php."),(0,o.kt)("h3",{id:"5-entrega-una-prueba-de-funcionamiento-donde-se-vea-como-se-realiza-una-conexi\xf3n-a-la-base-de-datos-desde-bravo"},"5. Entrega una prueba de funcionamiento donde se vea como se realiza una conexi\xf3n a la base de datos desde bravo."),(0,o.kt)("p",null,"*Nota: Para las views y zones ext.,int. y dmz \u2192 ",(0,o.kt)("a",{parentName:"p",href:"https://www.josedomingo.org/pledin/2017/12/vistas-views-en-el-servidor-dns-bind9/"},"https://www.josedomingo.org/pledin/2017/12/vistas-views-en-el-servidor-dns-bind9/")))}u.isMDXComponent=!0}}]);