"use strict";(self.webpackChunkotter_shell=self.webpackChunkotter_shell||[]).push([[2857],{3905:(e,a,l)=>{l.d(a,{Zo:()=>c,kt:()=>v});var o=l(67294);function n(e,a,l){return a in e?Object.defineProperty(e,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[a]=l,e}function r(e,a){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),l.push.apply(l,o)}return l}function i(e){for(var a=1;a<arguments.length;a++){var l=null!=arguments[a]?arguments[a]:{};a%2?r(Object(l),!0).forEach((function(a){n(e,a,l[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):r(Object(l)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(l,a))}))}return e}function s(e,a){if(null==e)return{};var l,o,n=function(e,a){if(null==e)return{};var l,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)l=r[o],a.indexOf(l)>=0||(n[l]=e[l]);return n}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)l=r[o],a.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(n[l]=e[l])}return n}var d=o.createContext({}),t=function(e){var a=o.useContext(d),l=a;return e&&(l="function"==typeof e?e(a):i(i({},a),e)),l},c=function(e){var a=t(e.components);return o.createElement(d.Provider,{value:a},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var a=e.children;return o.createElement(o.Fragment,{},a)}},m=o.forwardRef((function(e,a){var l=e.components,n=e.mdxType,r=e.originalType,d=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=t(l),m=n,v=u["".concat(d,".").concat(m)]||u[m]||p[m]||r;return l?o.createElement(v,i(i({ref:a},c),{},{components:l})):o.createElement(v,i({ref:a},c))}));function v(e,a){var l=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var r=l.length,i=new Array(r);i[0]=m;var s={};for(var d in a)hasOwnProperty.call(a,d)&&(s[d]=a[d]);s.originalType=e,s[u]="string"==typeof e?e:n,i[1]=s;for(var t=2;t<r;t++)i[t]=l[t];return o.createElement.apply(null,i)}return o.createElement.apply(null,l)}m.displayName="MDXCreateElement"},45765:(e,a,l)=>{l.r(a),l.d(a,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>t});var o=l(87462),n=(l(67294),l(3905));const r={sidebar_position:59},i="Kubernetes: Trabajando con Deployments",s={unversionedId:"Tasks/kubernetes_deployments",id:"Tasks/kubernetes_deployments",title:"Kubernetes: Trabajando con Deployments",description:"EJERCICIIO 1: Trabajando con Deployments",source:"@site/docs/Tasks/kubernetes_deployments.md",sourceDirName:"Tasks",slug:"/Tasks/kubernetes_deployments",permalink:"/docs/Tasks/kubernetes_deployments",draft:!1,editUrl:"https://github.com/belennazareth/ottershell/blob/main/docs/Tasks/kubernetes_deployments.md",tags:[],version:"current",sidebarPosition:59,frontMatter:{sidebar_position:59},sidebar:"tutorialSidebar",previous:{title:"Kubernetes: Trabajando con ReplicaSet",permalink:"/docs/Tasks/kubernetes_replicaset"},next:{title:"Markdown Features",permalink:"/docs/Tasks/markdown-features"}},d={},t=[{value:"EJERCICIIO 1: Trabajando con Deployments",id:"ejerciciio-1-trabajando-con-deployments",level:2},{value:"Entrega",id:"entrega",level:2},{value:"1. Pantallazo del fichero yaml que has creado con la definici\xf3n del Deployment.",id:"1-pantallazo-del-fichero-yaml-que-has-creado-con-la-definici\xf3n-del-deployment",level:3},{value:"2. Pantallazo donde se comprueba los recursos que se han creado.",id:"2-pantallazo-donde-se-comprueba-los-recursos-que-se-han-creado",level:3},{value:"3. Pantallazo donde se ve la informaci\xf3n detallada del Deployment.",id:"3-pantallazo-donde-se-ve-la-informaci\xf3n-detallada-del-deployment",level:3},{value:"4. Pantallazo donde se vea el acceso desde un navegador web a la aplicaci\xf3n usando el port-forward.",id:"4-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-aplicaci\xf3n-usando-el-port-forward",level:3},{value:"5. Pantallazo donde se vea los logs del despliegue despu\xe9s del acceso.",id:"5-pantallazo-donde-se-vea-los-logs-del-despliegue-despu\xe9s-del-acceso",level:3},{value:"EJERCICIO 2: Actualizaci\xf3n y desactualizaci\xf3n de nuestra aplicaci\xf3n",id:"ejercicio-2-actualizaci\xf3n-y-desactualizaci\xf3n-de-nuestra-aplicaci\xf3n",level:2},{value:"Entrega",id:"entrega-1",level:2},{value:"1. Pantallazo donde se vea el acceso desde un navegador web a la version 1 de la aplicaci\xf3n.",id:"1-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-1-de-la-aplicaci\xf3n",level:3},{value:"2. Pantallazo donde se vea el acceso desde un navegador web a la version 2 de la aplicaci\xf3n.",id:"2-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-2-de-la-aplicaci\xf3n",level:3},{value:"3. Pantallazo donde se visualice el historial de actualizaci\xf3n del despliegue despu\xe9s de actualizar a la versi\xf3n 2.",id:"3-pantallazo-donde-se-visualice-el-historial-de-actualizaci\xf3n-del-despliegue-despu\xe9s-de-actualizar-a-la-versi\xf3n-2",level:3},{value:"4. Pantallazo donde se vea el acceso desde un navegador web a la version 3 de la aplicaci\xf3n (\xa1\xa1\xa1No se visualiza bien la hoja de estilos!!!).",id:"4-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-3-de-la-aplicaci\xf3n-no-se-visualiza-bien-la-hoja-de-estilos",level:3},{value:"5. Pantallazo donde se visualice el historial de actualizaci\xf3n despu\xe9s de realizar el rollback del despliegue.",id:"5-pantallazo-donde-se-visualice-el-historial-de-actualizaci\xf3n-despu\xe9s-de-realizar-el-rollback-del-despliegue",level:3},{value:"6. Pantallazo donde se vea el acceso desde un navegador web a la version de la aplicaci\xf3n que queda despu\xe9s de hacer el rollout.",id:"6-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-de-la-aplicaci\xf3n-que-queda-despu\xe9s-de-hacer-el-rollout",level:3},{value:"EJERCICIO 3: Despliegue de la aplicaci\xf3n GuestBook",id:"ejercicio-3-despliegue-de-la-aplicaci\xf3n-guestbook",level:2},{value:"Entrega",id:"entrega-2",level:2},{value:"1. Pantallazo donde se comprueba los recursos que se han creado.",id:"1-pantallazo-donde-se-comprueba-los-recursos-que-se-han-creado",level:3},{value:"2. Pantallazo donde se vea el acceso desde un navegador web a la aplicaci\xf3n usando el port-forward, y se vea el mensaje de error al no poder acceder a la base de datos.",id:"2-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-aplicaci\xf3n-usando-el-port-forward-y-se-vea-el-mensaje-de-error-al-no-poder-acceder-a-la-base-de-datos",level:3}],c={toc:t},u="wrapper";function p(e){let{components:a,...l}=e;return(0,n.kt)(u,(0,o.Z)({},c,l,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"kubernetes-trabajando-con-deployments"},"Kubernetes: Trabajando con Deployments"),(0,n.kt)("h2",{id:"ejerciciio-1-trabajando-con-deployments"},"EJERCICIIO 1: Trabajando con Deployments"),(0,n.kt)("p",null,"En este taller vamos a crear un Deployment de una aplicaci\xf3n web. Sigamos los siguientes pasos:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Crea un fichero yaml con la descripci\xf3n del recurso Deployment, teniendo en cuenta los siguientes aspectos:",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Indica nombres distintos para el Deployment y para el contenedor de los Pods que va a controlar."),(0,n.kt)("li",{parentName:"ul"},"El Deployment va a crear 2 r\xe9plicas."),(0,n.kt)("li",{parentName:"ul"},"La imagen que debes desplegar es iesgn/test_web:latest."),(0,n.kt)("li",{parentName:"ul"},"Indica de manera adecuada una etiqueta en la especificaci\xf3n del Pod que vas a definir que coincida con el selector del Deployment."))),(0,n.kt)("li",{parentName:"ol"},"Crea el Deployment."),(0,n.kt)("li",{parentName:"ol"},"Comprueba los recursos que se han creado: Deployment, ReplicaSet y Pods."),(0,n.kt)("li",{parentName:"ol"},"Obt\xe9n informaci\xf3n detallada del Deployment creado."),(0,n.kt)("li",{parentName:"ol"},"Crea un una redirecci\xf3n utilizando el port-forward para acceder a la aplicaci\xf3n, sabiendo que la aplicaci\xf3n ofrece el servicio en el puerto 80, y accede a la aplicaci\xf3n con un navegador web."),(0,n.kt)("li",{parentName:"ol"},"Accede a los logs del despliegue para comprobar el acceso que has hecho en el punto anterior."),(0,n.kt)("li",{parentName:"ol"},"Elimina el Deployment y comprueba que se han borrado todos los recursos creados.")),(0,n.kt)("h2",{id:"entrega"},"Entrega"),(0,n.kt)("h3",{id:"1-pantallazo-del-fichero-yaml-que-has-creado-con-la-definici\xf3n-del-deployment"},"1. Pantallazo del fichero yaml que has creado con la definici\xf3n del Deployment."),(0,n.kt)("h3",{id:"2-pantallazo-donde-se-comprueba-los-recursos-que-se-han-creado"},"2. Pantallazo donde se comprueba los recursos que se han creado."),(0,n.kt)("h3",{id:"3-pantallazo-donde-se-ve-la-informaci\xf3n-detallada-del-deployment"},"3. Pantallazo donde se ve la informaci\xf3n detallada del Deployment."),(0,n.kt)("h3",{id:"4-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-aplicaci\xf3n-usando-el-port-forward"},"4. Pantallazo donde se vea el acceso desde un navegador web a la aplicaci\xf3n usando el port-forward."),(0,n.kt)("h3",{id:"5-pantallazo-donde-se-vea-los-logs-del-despliegue-despu\xe9s-del-acceso"},"5. Pantallazo donde se vea los logs del despliegue despu\xe9s del acceso."),(0,n.kt)("h2",{id:"ejercicio-2-actualizaci\xf3n-y-desactualizaci\xf3n-de-nuestra-aplicaci\xf3n"},"EJERCICIO 2: Actualizaci\xf3n y desactualizaci\xf3n de nuestra aplicaci\xf3n"),(0,n.kt)("p",null,"El equipo de desarrollo ha creado una primera versi\xf3n preliminar de una aplicaci\xf3n web y ha creado una imagen de contenedor con el siguiente nombre: iesgn/test_web:version1."),(0,n.kt)("p",null,"Vamos a desplegar esta primera versi\xf3n de la aplicaci\xf3n, para ello:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Crea un fichero yaml (puedes usar el de la actividad anterior) para desplegar la imagen: iesgn/test_web:version1."),(0,n.kt)("li",{parentName:"ol"},"Crea el Deployment, recuerda realizar una anotaci\xf3n para indicar las caracter\xedsticas del despliegue."),(0,n.kt)("li",{parentName:"ol"},"Crea una redirecci\xf3n utilizando el port-forward para acceder a la aplicaci\xf3n, sabiendo que la aplicaci\xf3n ofrece el servicio en el puerto 80, y accede a la aplicaci\xf3n con un navegador web.")),(0,n.kt)("p",null,"Nuestro equipo de desarrollo ha seguido trabajando y ya tiene lista la versi\xf3n 2 de nuestra aplicaci\xf3n, han creado una imagen que se llama: iesgn/test_web:version2. Vamos a actualizar nuestro despliegue con la nueva versi\xf3n, para ello:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Realiza la actualizaci\xf3n del despliegue utilizando la nueva imagen (no olvides anotar la causa)."),(0,n.kt)("li",{parentName:"ol"},"Comprueba los recursos que se han creado: Deployment, ReplicaSet y Pods."),(0,n.kt)("li",{parentName:"ol"},"Visualiza el historial de actualizaciones."),(0,n.kt)("li",{parentName:"ol"},"Crea una redirecci\xf3n utilizando el port-forward para acceder a la aplicaci\xf3n, sabiendo que la aplicaci\xf3n ofrece el servicio en el puerto 80, y accede a la aplicaci\xf3n con un navegador web.")),(0,n.kt)("p",null,"Finalmente despu\xe9s de un trabajo muy duro, el equipo de desarrollo ha creado la imagen iesgn/test_web:version3 con la \xfaltima versi\xf3n de nuestra aplicaci\xf3n y la vamos a poner en producci\xf3n, para ello:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Realiza la actualizaci\xf3n del despliegue utilizando la nueva imagen (no olvides anotar la causa)."),(0,n.kt)("li",{parentName:"ol"},"Comprueba los recursos que se han creado: Deployment, ReplicaSet y Pods."),(0,n.kt)("li",{parentName:"ol"},"Visualiza el historial de actualizaciones."),(0,n.kt)("li",{parentName:"ol"},"Crea una redirecci\xf3n utilizando el port-forward para acceder a la aplicaci\xf3n, sabiendo que la aplicaci\xf3n ofrece el servicio en el puerto 80, y accede a la aplicaci\xf3n con un navegador web.")),(0,n.kt)("p",null,"\xa1Vaya!, parece que esta versi\xf3n tiene un fallo, y no se ve de forma adecuada la hoja de estilos, tenemos que volver a la versi\xf3n anterior:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Ejecuta la instrucci\xf3n que nos permite hacer un rollback de nuestro despliegue."),(0,n.kt)("li",{parentName:"ol"},"Comprueba los recursos que se han creado: Deployment, ReplicaSet y Pods."),(0,n.kt)("li",{parentName:"ol"},"Visualiza el historial de actualizaciones."),(0,n.kt)("li",{parentName:"ol"},"Crea una redirecci\xf3n utilizando el port-forward para acceder a la aplicaci\xf3n, sabiendo que la aplicaci\xf3n ofrece el servicio en el puerto 80, y accede a la aplicaci\xf3n con un navegador web.")),(0,n.kt)("h2",{id:"entrega-1"},"Entrega"),(0,n.kt)("h3",{id:"1-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-1-de-la-aplicaci\xf3n"},"1. Pantallazo donde se vea el acceso desde un navegador web a la version 1 de la aplicaci\xf3n."),(0,n.kt)("h3",{id:"2-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-2-de-la-aplicaci\xf3n"},"2. Pantallazo donde se vea el acceso desde un navegador web a la version 2 de la aplicaci\xf3n."),(0,n.kt)("h3",{id:"3-pantallazo-donde-se-visualice-el-historial-de-actualizaci\xf3n-del-despliegue-despu\xe9s-de-actualizar-a-la-versi\xf3n-2"},"3. Pantallazo donde se visualice el historial de actualizaci\xf3n del despliegue despu\xe9s de actualizar a la versi\xf3n 2."),(0,n.kt)("h3",{id:"4-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-3-de-la-aplicaci\xf3n-no-se-visualiza-bien-la-hoja-de-estilos"},"4. Pantallazo donde se vea el acceso desde un navegador web a la version 3 de la aplicaci\xf3n (\xa1\xa1\xa1No se visualiza bien la hoja de estilos!!!)."),(0,n.kt)("h3",{id:"5-pantallazo-donde-se-visualice-el-historial-de-actualizaci\xf3n-despu\xe9s-de-realizar-el-rollback-del-despliegue"},"5. Pantallazo donde se visualice el historial de actualizaci\xf3n despu\xe9s de realizar el rollback del despliegue."),(0,n.kt)("h3",{id:"6-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-version-de-la-aplicaci\xf3n-que-queda-despu\xe9s-de-hacer-el-rollout"},"6. Pantallazo donde se vea el acceso desde un navegador web a la version de la aplicaci\xf3n que queda despu\xe9s de hacer el rollout."),(0,n.kt)("h2",{id:"ejercicio-3-despliegue-de-la-aplicaci\xf3n-guestbook"},"EJERCICIO 3: Despliegue de la aplicaci\xf3n GuestBook"),(0,n.kt)("p",null,"En esta tarea vamos a desplegar una aplicaci\xf3n web que requiere de dos servicios para su ejecuci\xf3n. La aplicaci\xf3n se llama GuestBook y necesita los siguientes servicios:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"La aplicaci\xf3n Guestbook es una aplicaci\xf3n web desarrollada en python que es servida en el puerto 5000/tcp. Utilizaremos la imagen iesgn/guestbook."),(0,n.kt)("li",{parentName:"ul"},"Esta aplicaci\xf3n guarda la informaci\xf3n en una base de datos no relacional redis, que utiliza el puerto 6379/tcp para recibir las conexiones. Usaremos la imagen redis.")),(0,n.kt)("p",null,"Por lo tanto si tenemos dos servicios distintos, tendremos dos ficheros yaml para crear dos recursos Deployment, uno para cada servicio. Con esta manera de trabajar podemos obtener las siguientes caracter\xedsticas:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Cada conjunto de Pods creado en cada despliegue ejecutar\xe1n un solo proceso para ofrecer el servicio."),(0,n.kt)("li",{parentName:"ol"},"Cada conjunto de Pods se puede escalar de manera independiente. Esto es importante, si identificamos que al acceder a alguno de los servicios se crea un cuello de botella, podemos escalarlo para tener m\xe1s Pods ejecutando el servicio."),(0,n.kt)("li",{parentName:"ol"},"Las actualizaciones de los distintos servicios no interfieren en el resto."),(0,n.kt)("li",{parentName:"ol"},"Lo estudiaremos en un m\xf3dulo posterior, pero podremos gestionar el almacenamiento de cada servicio de forma independiente.")),(0,n.kt)("p",null,"Por lo tanto para desplegar la aplicaciones tendremos dos ficheros.yaml:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://raw.githubusercontent.com/josedom24/curso_kubernetes_ies/main/modulo6/files/guestbook/guestbook-deployment.yaml"},"guestbook-deployment.yaml")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://raw.githubusercontent.com/josedom24/curso_kubernetes_ies/main/modulo6/files/guestbook/redis-deployment.yaml"},"redis-deployment.yaml"))),(0,n.kt)("p",null,"Para realizar el despliegue realiza los siguientes pasos:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Usando los ficheros anteriores crea los dos Deployments."),(0,n.kt)("li",{parentName:"ol"},"Comprueba que los recursos que se han creado: Deployment, ReplicaSet y Pods."),(0,n.kt)("li",{parentName:"ol"},"Crea una redirecci\xf3n utilizando el port-forward para acceder a la aplicaci\xf3n, sabiendo que la aplicaci\xf3n ofrece el servicio en el puerto 5000, y accede a la aplicaci\xf3n con un navegador web.")),(0,n.kt)("p",null,"\xbfQu\xe9 aparece en la p\xe1gina principal de la aplicaci\xf3n?. Aparece el siguiente mensaje: Waiting for database connection\u2026. Por lo tanto podemos indicar varias conclusiones:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Hasta ahora no estamos accediendo de forma \u201cnormal\u201d a las aplicaciones. El uso de la opci\xf3n port-forward es un mecanismo que realmente nos posibilita acceder a la aplicaci\xf3n, pero utilizando un proxy. Deber\xedamos acceder a las aplicaciones usando una ip y un puerto determinado."),(0,n.kt)("li",{parentName:"ol"},"Parece que tampoco hay acceso entre los Pods de los distintos despliegues. Parece que los Pods de la aplicaci\xf3n guestbook no pueden acceder al Pod donde se est\xe1 ejecutando la base de datos redis.")),(0,n.kt)("p",null,"En el siguiente m\xf3dulo estudiaremos los recursos que nos ofrece la API de Kubernetes para permitirnos el acceso a las aplicaciones desde el exterior, y para que los distintos Pods de los despliegues puedan acceder entre ellos."),(0,n.kt)("h2",{id:"entrega-2"},"Entrega"),(0,n.kt)("h3",{id:"1-pantallazo-donde-se-comprueba-los-recursos-que-se-han-creado"},"1. Pantallazo donde se comprueba los recursos que se han creado."),(0,n.kt)("h3",{id:"2-pantallazo-donde-se-vea-el-acceso-desde-un-navegador-web-a-la-aplicaci\xf3n-usando-el-port-forward-y-se-vea-el-mensaje-de-error-al-no-poder-acceder-a-la-base-de-datos"},"2. Pantallazo donde se vea el acceso desde un navegador web a la aplicaci\xf3n usando el port-forward, y se vea el mensaje de error al no poder acceder a la base de datos."))}p.isMDXComponent=!0}}]);