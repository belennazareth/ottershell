"use strict";(self.webpackChunkotter_shell=self.webpackChunkotter_shell||[]).push([[2087],{3905:(e,n,a)=>{a.d(n,{Zo:()=>d,kt:()=>m});var r=a(7294);function o(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function t(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?t(Object(a),!0).forEach((function(n){o(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function s(e,n){if(null==e)return{};var a,r,o=function(e,n){if(null==e)return{};var a,r,o={},t=Object.keys(e);for(r=0;r<t.length;r++)a=t[r],n.indexOf(a)>=0||(o[a]=e[a]);return o}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(r=0;r<t.length;r++)a=t[r],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=r.createContext({}),c=function(e){var n=r.useContext(l),a=n;return e&&(a="function"==typeof e?e(n):i(i({},n),e)),a},d=function(e){var n=c(e.components);return r.createElement(l.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var a=e.components,o=e.mdxType,t=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(a),m=o,v=u["".concat(l,".").concat(m)]||u[m]||p[m]||t;return a?r.createElement(v,i(i({ref:n},d),{},{components:a})):r.createElement(v,i({ref:n},d))}));function m(e,n){var a=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var t=a.length,i=new Array(t);i[0]=u;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var c=2;c<t;c++)i[c]=a[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},1356:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>c});var r=a(7462),o=(a(7294),a(3905));const t={sidebar_position:25},i="Redes Privadas Virtuales",s={unversionedId:"Tasks/vpn",id:"Tasks/vpn",title:"Redes Privadas Virtuales",description:"Procedimiento",source:"@site/docs/Tasks/vpn.md",sourceDirName:"Tasks",slug:"/Tasks/vpn",permalink:"/docs/Tasks/vpn",draft:!1,editUrl:"https://github.com/belennazareth/ottershell/blob/main/docs/Tasks/vpn.md",tags:[],version:"current",sidebarPosition:25,frontMatter:{sidebar_position:25},sidebar:"tutorialSidebar",previous:{title:"Despliegue de aplicaciones python",permalink:"/docs/Tasks/despliegue_python"},next:{title:"Markdown Features",permalink:"/docs/Tasks/markdown-features"}},l={},c=[{value:"Procedimiento",id:"procedimiento",level:2},{value:"Entrega",id:"entrega",level:2},{value:"VPN de acceso remoto con OpenVPN y certificados x509",id:"vpn-de-acceso-remoto-con-openvpn-y-certificados-x509",level:3},{value:"Escenario",id:"escenario",level:4},{value:"server",id:"server",level:4},{value:"VPN de acceso remoto con WireGuard",id:"vpn-de-acceso-remoto-con-wireguard",level:3},{value:"VPN de acceso remoto con WireGuard",id:"vpn-de-acceso-remoto-con-wireguard-1",level:3},{value:"VPN sitio a sitio con WireGuard",id:"vpn-sitio-a-sitio-con-wireguard",level:3}],d={toc:c};function p(e){let{components:n,...a}=e;return(0,o.kt)("wrapper",(0,r.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"redes-privadas-virtuales"},"Redes Privadas Virtuales"),(0,o.kt)("h2",{id:"procedimiento"},"Procedimiento"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"A) VPN de acceso remoto con OpenVPN y certificados x509 (5 puntos)")),(0,o.kt)("p",null,"Configura una conexi\xf3n VPN de acceso remoto entre dos equipos del cloud:"),(0,o.kt)("p",null,"\u2022 Uno de los dos equipos (el que actuar\xe1 como servidor) estar\xe1 conectado a dos redes\n\u2022 Para la autenticaci\xf3n de los extremos se usar\xe1n obligatoriamente certificados digitales, que se generar\xe1n utilizando openssl y se almacenar\xe1n en el directorio /etc/openvpn, junto con  los par\xe1metros Diffie-Helman y el certificado de la propia Autoridad de Certificaci\xf3n.\n\u2022 Se utilizar\xe1n direcciones de la red 10.99.99.0/24 para las direcciones virtuales de la VPN. La direcci\xf3n 10.99.99.1 se asignar\xe1 al servidor VPN.\n\u2022 Los ficheros de configuraci\xf3n del servidor y del client se crear\xe1n en el directorio /etc/openvpn de cada m\xe1quina, y se llamar\xe1n servidor.conf y client.conf respectivamente.\n\u2022 Tras el establecimiento de la VPN, la m\xe1quina client debe ser capaz de acceder a una m\xe1quina que est\xe9 en la otra red a la que est\xe1 conectado el servidor.\nDocumenta el proceso detalladamente."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"B) VPN sitio a sitio con OpenVPN y certificados x509 (10 puntos)")),(0,o.kt)("p",null,"Configura una conexi\xf3n VPN sitio a sitio entre dos equipos del cloud:"),(0,o.kt)("p",null,"\u2022 Cada equipo estar\xe1 conectado a dos redes, una de ellas en com\xfan\n\u2022 Para la autenticaci\xf3n de los extremos se usar\xe1n obligatoriamente certificados digitales, que se generar\xe1n utilizando openssl y se almacenar\xe1n en el directorio /etc/openvpn, junto con con los par\xe1metros Diffie-Helman y el certificado de la propia Autoridad de Certificaci\xf3n.\n\u2022 Se utilizar\xe1n direcciones de la red 10.99.99.0/24 para las direcciones virtuales de la VPN.\n\u2022 Tras el establecimiento de la VPN, una m\xe1quina de cada red detr\xe1s de cada servidor VPN debe ser capaz de acceder a una m\xe1quina del otro extremo.\nDocumenta el proceso detalladamente."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"C) VPN de acceso remoto con WireGuard (5 puntos)")),(0,o.kt)("p",null,"Monta una VPN de acceso remoto usando Wireguard. Intenta probarla con clients Windows, Linux y Android. Documenta el proceso adecuadamente y comp\xe1ralo con el del apartado A."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"D) VPN sitio a sitio con WireGuard (10 puntos)")),(0,o.kt)("p",null,"Configura una VPN sitio a sitio usando WireGuard. Documenta el proceso adecuadamente y comp\xe1ralo con el del apartado B."),(0,o.kt)("p",null,"Extra 1) VPN de acceso remoto con Ipsec (5 puntos)"),(0,o.kt)("p",null,"Elige una aplicaci\xf3n por software (por ejemplo, FreeS/Wan) y monta la configuraci\xf3n. Documenta el proceso detalladamente."),(0,o.kt)("p",null,"Extra 2) VPN sitio a sitio con IPsec (10 puntos)"),(0,o.kt)("p",null,"Montando el escenario en GNS3 usando routers CISCO o con una aplicaci\xf3n por software (por ejemplo, FreeS/Wan) despliega la configuraci\xf3n solicitada. Documenta el proceso detalladamente."),(0,o.kt)("h2",{id:"entrega"},"Entrega"),(0,o.kt)("h3",{id:"vpn-de-acceso-remoto-con-openvpn-y-certificados-x509"},"VPN de acceso remoto con OpenVPN y certificados x509"),(0,o.kt)("h4",{id:"escenario"},"Escenario"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-vagrantfile"},'Vagrant.configure("2") do |config|\n\nconfig.vm.synced_folder ".", "/vagrant", disabled: true\n\n  config.vm.provider :libvirt do |libvirt|\n    libvirt.cpus = 1\n    libvirt.memory = 512\n  end\n\n  config.vm.define :client do |client|\n    client.vm.box = "debian/bullseye64"\n    client.vm.hostname = "client"\n    client.vm.network :private_network,\n      :libvirt__network_name => "externa",\n      :libvirt__dhcp_enabled => false,\n      :ip => "192.168.22.15",\n      :libvirt__netmask => \'255.255.255.0\',\n      :libvirt__forward_mode => "veryisolated"\n  end\n\n  config.vm.define :server do |server|\n    server.vm.box = "debian/bullseye64"\n    server.vm.hostname = "server"\n    server.vm.network :private_network,\n      :libvirt__network_name => "externa",\n      :libvirt__dhcp_enabled => false,\n      :ip => "192.168.22.17",\n      :libvirt__netmask => \'255.255.255.0\',\n      :libvirt__forward_mode => "veryisolated"\n    server.vm.network :private_network,\n      :libvirt__network_name => "interna-vpn",\n      :libvirt__dhcp_enabled => false,\n      :ip => "172.22.0.5",\n      :libvirt__netmask => \'255.255.255.0\',\n      :libvirt__forward_mode => "veryisolated"\n  end\n\n  config.vm.define :maquina1 do |maquina1|\n    maquina1.vm.box = "debian/bullseye64"\n    maquina1.vm.hostname = "maquina1"\n    maquina1.vm.network :private_network,\n      :libvirt__network_name => "interna",\n      :libvirt__dhcp_enabled => false,\n      :ip => "172.22.0.7",\n      :libvirt__netmask => \'255.255.255.0\',\n      :libvirt__forward_mode => "veryisolated"\n  end\n\nend\n')),(0,o.kt)("h4",{id:"server"},"server"),(0,o.kt)("p",null,"Instalamos openvpn:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"apt install openvpn\n")),(0,o.kt)("p",null,"Y habilitamos el bit de forwarding:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"echo 1 > /proc/sys/net/ipv4/ip_forward\n")),(0,o.kt)("p",null,"A continuaci\xf3n, copiamos el fichero de configuraci\xf3n del servidor de /usr/share/easy-rsa a /etc/openvpn, ya que es el directorio donde se van a guardar los ficheros de configuraci\xf3n de openvpn y de esta manera se convierte en el directorio por defecto en el que se buscan los ficheros de configuraci\xf3n:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo cp -r /usr/share/easy-rsa /etc/openvpn\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@server:/etc/openvpn# ls\n\nclient  easy-rsa  server  update-resolv-conf\n")),(0,o.kt)("p",null,"Despu\xe9s, inicializamos el PKI de openvpn, que es el sistema de certificados que vamos a utilizar para generar la clave p\xfablica y privada del servidor:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo ./easyrsa init-pki\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@server:/etc/openvpn/easy-rsa# ./easyrsa init-pki\n\ninit-pki complete; you may now create a CA or requests.\nYour newly created PKI dir is: /etc/openvpn/easy-rsa/pki\n\n")),(0,o.kt)("h3",{id:"vpn-de-acceso-remoto-con-wireguard"},"VPN de acceso remoto con WireGuard"),(0,o.kt)("h3",{id:"vpn-de-acceso-remoto-con-wireguard-1"},"VPN de acceso remoto con WireGuard"),(0,o.kt)("h3",{id:"vpn-sitio-a-sitio-con-wireguard"},"VPN sitio a sitio con WireGuard"))}p.isMDXComponent=!0}}]);