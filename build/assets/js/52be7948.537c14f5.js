"use strict";(self.webpackChunkotter_shell=self.webpackChunkotter_shell||[]).push([[9233],{3905:(e,a,n)=>{n.d(a,{Zo:()=>c,kt:()=>m});var o=n(7294);function i(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function t(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);a&&(o=o.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?t(Object(n),!0).forEach((function(a){i(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function l(e,a){if(null==e)return{};var n,o,i=function(e,a){if(null==e)return{};var n,o,i={},t=Object.keys(e);for(o=0;o<t.length;o++)n=t[o],a.indexOf(n)>=0||(i[n]=e[n]);return i}(e,a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(o=0;o<t.length;o++)n=t[o],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=o.createContext({}),d=function(e){var a=o.useContext(s),n=a;return e&&(n="function"==typeof e?e(a):r(r({},a),e)),n},c=function(e){var a=d(e.components);return o.createElement(s.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return o.createElement(o.Fragment,{},a)}},p=o.forwardRef((function(e,a){var n=e.components,i=e.mdxType,t=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(n),m=i,N=p["".concat(s,".").concat(m)]||p[m]||u[m]||t;return n?o.createElement(N,r(r({ref:a},c),{},{components:n})):o.createElement(N,r({ref:a},c))}));function m(e,a){var n=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var t=n.length,r=new Array(t);r[0]=p;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var d=2;d<t;d++)r[d]=n[d];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},4403:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>t,metadata:()=>l,toc:()=>d});var o=n(7462),i=(n(7294),n(3905));const t={sidebar_position:29},r="Auditor\xeda",l={unversionedId:"Tasks/auditorias",id:"Tasks/auditorias",title:"Auditor\xeda",description:"Las auditor\xedas son un conjunto de t\xe9cnicas que permiten recopilar informaci\xf3n sobre el uso de un sistema inform\xe1tico. La auditor\xeda de un sistema inform\xe1tico consiste en la recopilaci\xf3n de informaci\xf3n sobre el uso de un sistema inform\xe1tico, con el fin de verificar que el sistema se est\xe1 utilizando de forma correcta y que los usuarios est\xe1n cumpliendo con las pol\xedticas de seguridad establecidas.",source:"@site/docs/Tasks/auditorias.md",sourceDirName:"Tasks",slug:"/Tasks/auditorias",permalink:"/docs/Tasks/auditorias",draft:!1,editUrl:"https://github.com/belennazareth/ottershell/blob/main/docs/Tasks/auditorias.md",tags:[],version:"current",sidebarPosition:29,frontMatter:{sidebar_position:29},sidebar:"tutorialSidebar",previous:{title:"Introducci\xf3n a iSCSI",permalink:"/docs/Tasks/iSCSI"},next:{title:"Delegaci\xf3n de subdominios con bind9",permalink:"/docs/Tasks/bind9_subdominios"}},s={},d=[{value:"1. Activa desde SQL*Plus la auditor\xeda de los intentos de acceso exitosos al sistema. Comprueba su funcionamiento.",id:"1-activa-desde-sqlplus-la-auditor\xeda-de-los-intentos-de-acceso-exitosos-al-sistema-comprueba-su-funcionamiento",level:2},{value:"2. Realiza un procedimiento en PL/SQL que te muestre los accesos fallidos junto con el motivo de los mismos, transformando el c\xf3digo de error almacenado en un mensaje de texto comprensible. Contempla todos los motivos posibles para que un acceso sea fallido.",id:"2-realiza-un-procedimiento-en-plsql-que-te-muestre-los-accesos-fallidos-junto-con-el-motivo-de-los-mismos-transformando-el-c\xf3digo-de-error-almacenado-en-un-mensaje-de-texto-comprensible-contempla-todos-los-motivos-posibles-para-que-un-acceso-sea-fallido",level:2},{value:"3. Activa la auditor\xeda de las operaciones DML realizadas por SCOTT. Comprueba su funcionamiento.",id:"3-activa-la-auditor\xeda-de-las-operaciones-dml-realizadas-por-scott-comprueba-su-funcionamiento",level:2},{value:"4. Realiza una auditor\xeda de grano fino para almacenar informaci\xf3n sobre la inserci\xf3n de empleados con sueldo superior a 2000 en la tabla emp de scott.",id:"4-realiza-una-auditor\xeda-de-grano-fino-para-almacenar-informaci\xf3n-sobre-la-inserci\xf3n-de-empleados-con-sueldo-superior-a-2000-en-la-tabla-emp-de-scott",level:2},{value:"5. Explica la diferencia entre auditar una operaci\xf3n by access o by session ilustr\xe1ndolo con ejemplos.",id:"5-explica-la-diferencia-entre-auditar-una-operaci\xf3n-by-access-o-by-session-ilustr\xe1ndolo-con-ejemplos",level:2},{value:"6. Documenta las diferencias entre los valores db y db, extended del par\xe1metro audit_trail de ORACLE. Demu\xe9stralas poniendo un ejemplo de la informaci\xf3n sobre una operaci\xf3n concreta recopilada con cada uno de ellos.",id:"6-documenta-las-diferencias-entre-los-valores-db-y-db-extended-del-par\xe1metro-audit_trail-de-oracle-demu\xe9stralas-poniendo-un-ejemplo-de-la-informaci\xf3n-sobre-una-operaci\xf3n-concreta-recopilada-con-cada-uno-de-ellos",level:2},{value:"7. Averigua si en Postgres se pueden realizar los cuatro primeros apartados. Si es as\xed, documenta el proceso adecuadamente.",id:"7-averigua-si-en-postgres-se-pueden-realizar-los-cuatro-primeros-apartados-si-es-as\xed-documenta-el-proceso-adecuadamente",level:2},{value:"8. Averigua si en MySQL se pueden realizar los apartados 1, 3 y 4. Si es as\xed, documenta el proceso adecuadamente.",id:"8-averigua-si-en-mysql-se-pueden-realizar-los-apartados-1-3-y-4-si-es-as\xed-documenta-el-proceso-adecuadamente",level:2},{value:"9. Averigua las posibilidades que ofrece MongoDB para auditar los cambios que va sufriendo un documento. Demuestra su funcionamiento.",id:"9-averigua-las-posibilidades-que-ofrece-mongodb-para-auditar-los-cambios-que-va-sufriendo-un-documento-demuestra-su-funcionamiento",level:2},{value:"10. Averigua si en MongoDB se pueden auditar los accesos a una colecci\xf3n concreta. Demuestra su funcionamiento.",id:"10-averigua-si-en-mongodb-se-pueden-auditar-los-accesos-a-una-colecci\xf3n-concreta-demuestra-su-funcionamiento",level:2}],c={toc:d};function u(e){let{components:a,...t}=e;return(0,i.kt)("wrapper",(0,o.Z)({},c,t,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"auditor\xeda"},"Auditor\xeda"),(0,i.kt)("p",null,"Las ",(0,i.kt)("strong",{parentName:"p"},"auditor\xedas")," son un conjunto de t\xe9cnicas que permiten recopilar informaci\xf3n sobre el uso de un sistema inform\xe1tico. La auditor\xeda de un sistema inform\xe1tico consiste en la recopilaci\xf3n de informaci\xf3n sobre el uso de un sistema inform\xe1tico, con el fin de verificar que el sistema se est\xe1 utilizando de forma correcta y que los usuarios est\xe1n cumpliendo con las pol\xedticas de seguridad establecidas."),(0,i.kt)("p",null,"\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\ud83e\udda6\u200a                 \ud83e\udda6\u200a                    \ud83e\udda6\u200a                     \ud83e\udda6\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164"),(0,i.kt)("h2",{id:"1-activa-desde-sqlplus-la-auditor\xeda-de-los-intentos-de-acceso-exitosos-al-sistema-comprueba-su-funcionamiento"},"1. Activa desde SQL*Plus la auditor\xeda de los intentos de acceso exitosos al sistema. Comprueba su funcionamiento."),(0,i.kt)("p",null,"Con la siguiente consulta veremos las auditor\xedas que tenemos:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select name, value from v$parameter where name like '%audit%';\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Auditoria",src:n(207).Z,width:"866",height:"912"})),(0,i.kt)("p",null,"Tambi\xe9n podemos verlo con la siguiente consulta:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"select name, value from v$parameter where name like 'audit_trail';\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Auditoria",src:n(5553).Z,width:"775",height:"258"})),(0,i.kt)("p",null,"Y comprobamos que en la l\xednea ",(0,i.kt)("inlineCode",{parentName:"p"},"audit_trail")," tenemos el valor ",(0,i.kt)("inlineCode",{parentName:"p"},"db"),", con esto sabremos que la auditor\xeda est\xe1 activada. Si no lo estuviera, tendr\xedamos que activarla con la siguiente consulta:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"alter system set audit_trail=db scope=spfile;\n")),(0,i.kt)("p",null,"En caso de querer desactivarla, se har\xeda con la siguiente consulta:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"alter system set audit_trail=none scope=spfile;\n")),(0,i.kt)("p",null,"Activamos la auditor\xeda de los intentos de acceso exitosos al sistema con la siguiente consulta:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"AUDIT CREATE SESSION WHENEVER SUCCESSFUL;\n")),(0,i.kt)("p",null,"*Nota: importante que est\xe9 en may\xfasculas."),(0,i.kt)("p",null,"Entramos con otro usuario y consultamos la tabla de sesiones de auditor\xeda:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT OS_USERNAME, USERNAME, EXTENDED_TIMESTAMP, ACTION_NAME FROM DBA_AUDIT_SESSION;\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Auditoria",src:n(5214).Z,width:"929",height:"358"})),(0,i.kt)("h2",{id:"2-realiza-un-procedimiento-en-plsql-que-te-muestre-los-accesos-fallidos-junto-con-el-motivo-de-los-mismos-transformando-el-c\xf3digo-de-error-almacenado-en-un-mensaje-de-texto-comprensible-contempla-todos-los-motivos-posibles-para-que-un-acceso-sea-fallido"},"2. Realiza un procedimiento en PL/SQL que te muestre los accesos fallidos junto con el motivo de los mismos, transformando el c\xf3digo de error almacenado en un mensaje de texto comprensible. Contempla todos los motivos posibles para que un acceso sea fallido."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"IMPORTANTE")," Para esto hay que tener activo la auditor\xeda de los intentos de acceso fallidos al sistema. Para ello, ejecutamos:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"AUDIT CREATE SESSION WHENEVER NOT SUCCESSFUL;\n")),(0,i.kt)("p",null,"Los posibles motivos que he valorado para que un acceso sea fallido son:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01017: invalid username/password; logon denied")," -> Usuario o contrase\xf1a incorrectos."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28001: the password has expired")," -> Contrase\xf1a caducada."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12154: TNS: could not resolve the connect identifier specified")," -> No se ha podido resolver el identificador de conexi\xf3n especificado."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-02396: exceeded maximum idle time, please connect again")," -> Se ha excedido el tiempo m\xe1ximo de inactividad, por favor, conecte de nuevo."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28000: the account is locked")," -> La cuenta est\xe1 bloqueada."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12545: connect failed because target host or object does not exist")," -> La conexi\xf3n fall\xf3 porque el host de destino o el objeto no existe."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12560: TNS: protocol adapter error")," -> Error de adaptador de protocolo TNS."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28002: the password will expire within X days")," -> La contrase\xf1a caducar\xe1 dentro de X d\xedas."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12514: TNS: listener does not currently know of service requested in connect descriptor")," -> El listener no conoce actualmente el servicio solicitado en el descriptor de conexi\xf3n."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-00604: error occurred at recursive SQL level 1")," -> Se produjo un error en el nivel SQL recursivo 1."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28003: password verification for the specified password failed")," -> La verificaci\xf3n de la contrase\xf1a para la contrase\xf1a especificada fall\xf3."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12170: TNS:Connect timeout occurred")," -> Se produjo un tiempo de espera de conexi\xf3n TNS."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28045: SSL authentication between the Oracle database server and the client failed")," -> La autenticaci\xf3n SSL entre el servidor de base de datos Oracle y el cliente fall\xf3."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28040: No matching authentication protocol")," -> No hay protocolo de autenticaci\xf3n coincidente."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28009: connection as SYS should be as SYSDBA or SYSOPER")," -> La conexi\xf3n como SYS debe ser como SYSDBA o SYSOPER."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01033: ORACLE initialization or shutdown in progress")," -> Inicializaci\xf3n o apagado de ORACLE en progreso."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-03113: end-of-file on communication channel")," -> Fin de archivo en el canal de comunicaci\xf3n."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12518: TNS:listener could not hand off client connection")," -> El listener no pudo transferir la conexi\xf3n del cliente."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28056: Invalid old password")," -> Contrase\xf1a antigua no v\xe1lida."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28083: password verification for the specified password failed")," -> La verificaci\xf3n de la contrase\xf1a para la contrase\xf1a especificada fall\xf3."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28011: the account will expire soon; change your password now")," -> La cuenta caducar\xe1 pronto; cambie su contrase\xf1a ahora."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-00600: internal error code, arguments: [kzsamclr_f], [], [], [], [], [], [], [], [], [], [], []")," -> C\xf3digo de error interno, argumentos: ","[kzsamclr_f]",", [], ..."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-03135: connection lost contact")," -> Se perdi\xf3 el contacto de la conexi\xf3n."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12571: TNS:packet writer failure")," -> Falla del escritor de paquetes TNS."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01005: null password given; logon denied")," -> Contrase\xf1a dada nula; acceso denegado."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28007: the password cannot be reused")," -> La contrase\xf1a no se puede volver a usar."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12162: TNS:net service name is incorrectly specified")," -> El nombre del servicio de red TNS est\xe1 especificado incorrectamente."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12505: TNS:listener does not currently know of SID given in connect descriptor")," -> El listener no conoce actualmente el SID dado en el descriptor de conexi\xf3n."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12537: TNS:connection closed")," -> Conexi\xf3n cerrada TNS."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28019: maximum number of granted roles exceeded")," -> Se excedi\xf3 el n\xfamero m\xe1ximo de roles otorgados."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01034: ORACLE not available")," -> ORACLE no disponible."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28079: cannot change sys/system password with SYSDBA/DBA privilege")," -> No se puede cambiar la contrase\xf1a de sys/system con privilegios SYSDBA/DBA."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-03127: no new operations allowed until the active operation ends")," -> No se permiten nuevas operaciones hasta que finalice la operaci\xf3n activa."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12543: TNS:destination host unreachable")," -> Host de destino TNS inalcanzable."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-10173: Dynamic sampling time-out")," -> Tiempo de espera de muestreo din\xe1mico."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12504: TNS:listener was not given the SERVICE_NAME in CONNECT_DATA")," -> El listener no se le dio el SERVICE_NAME en CONNECT_DATA."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12520: TNS:listener could not find available handler for requested type of server")," -> El listener no pudo encontrar un controlador disponible para el tipo de servidor solicitado."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12640: Authentication adapter initialization failed")," -> Fall\xf3 la inicializaci\xf3n del adaptador de autenticaci\xf3n."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-00942: table or view does not exist")," -> Tabla o vista no existe."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01031: insufficient privileges")," -> Privilegios insuficientes."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-24315: illegal attribute type")," -> Tipo de atributo ilegal."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-12161: TNS:internal error: partial data received: tnsparse-7")," -> Error interno TNS: datos parciales recibidos: tnsparse-7."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01045: CREATE SESSION privilege logon denied")," -> Acceso denegado, no tiene privilegios de CREAR SESI\xd3N.")),(0,i.kt)("p",null,"Hay otros muchos mas motivos, en los siguientes enlaces vemos todos los posibles errores que nos puede dar Oracle con sus c\xf3digos: ",(0,i.kt)("a",{parentName:"p",href:"https://www.dba-oracle.com/t_error_code_list.htm"},"https://www.dba-oracle.com/t_error_code_list.htm"),"  ---  ",(0,i.kt)("a",{parentName:"p",href:"https://docs.oracle.com/en/database/oracle/oracle-database/19/errmg/toc.htm"},"https://docs.oracle.com/en/database/oracle/oracle-database/19/errmg/toc.htm")),(0,i.kt)("p",null,"Los que voy a incluir en mi procedimiento son los siguientes:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01031: insufficient privileges")," -> Privilegios insuficientes."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01017: invalid username/password; logon denied")," -> Usuario o contrase\xf1a incorrectos."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01005: null password given; logon denied")," -> Contrase\xf1a dada nula; acceso denegado."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28001: the password has expired")," -> Contrase\xf1a caducada."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28009: connection as SYS should be as SYSDBA or SYSOPER")," -> La conexi\xf3n como SYS debe ser como SYSDBA o SYSOPER."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-28003: password verification for the specified password failed")," -> La verificaci\xf3n de la contrase\xf1a para la contrase\xf1a especificada fall\xf3."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-02396: exceeded maximum idle time, please connect again")," -> Se ha excedido el tiempo m\xe1ximo de inactividad, por favor, conecte de nuevo."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ORA-01045: CREATE SESSION privilege logon denied")," -> Acceso denegado, no tiene privilegios de CREAR SESI\xd3N.")),(0,i.kt)("p",null,"En el primer procedimiento, tendr\xe1 como dato de entrada el c\xf3digo de error, se incluir\xe1n todos los errores y los mensajes que saldr\xe1n en caso de que se produzca alguno de ellos. El segundo procedimiento ser\xe1 una llamada al primero y se ejecutar\xe1 en caso de que se produzca alguno de los errores que se han incluido en el primer procedimiento."),(0,i.kt)("p",null,"Los errores se encuentran almacenados en la tabla dba_audit_session, donde en la columna ",(0,i.kt)("inlineCode",{parentName:"p"},"returncode")," se almacena el c\xf3digo de error, en la columna ",(0,i.kt)("inlineCode",{parentName:"p"},"action_name")," se almacena el tipo de operaci\xf3n que se ha realizado y en la columna ",(0,i.kt)("inlineCode",{parentName:"p"},"extended_timestamp")," se almacena la fecha y hora en la que se ha producido el error, luego tenemos ",(0,i.kt)("inlineCode",{parentName:"p"},"username")," que es el usuario que ha realizado la operaci\xf3n:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"desc dba_audit_session;\n\nNombre                 ?Nulo?   Tipo\n----------------------------------------- -------- ----------------------------\nOS_USERNAME                         VARCHAR2(255)\nUSERNAME                            VARCHAR2(128)\nUSERHOST                            VARCHAR2(128)\nTERMINAL                            VARCHAR2(255)\nTIMESTAMP                           DATE\nACTION_NAME                         VARCHAR2(28)\nLOGOFF_TIME                         DATE\nLOGOFF_LREAD                        NUMBER\nLOGOFF_PREAD                        NUMBER\nLOGOFF_LWRITE                       NUMBER\nLOGOFF_DLOCK                        VARCHAR2(40)\nSESSIONID                NOT NULL   NUMBER\nRETURNCODE               NOT NULL   NUMBER\nCLIENT_ID                           VARCHAR2(128)\nSESSION_CPU                         NUMBER\nEXTENDED_TIMESTAMP                  TIMESTAMP(6) WITH TIME ZONE\nPROXY_SESSIONID                     NUMBER\nGLOBAL_UID                          VARCHAR2(32)\nINSTANCE_NUMBER                     NUMBER\nOS_PROCESS                          VARCHAR2(16)\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE OR REPLACE PROCEDURE audit_error (p_coderror DBA_AUDIT_SESSION.RETURNCODE%TYPE) AS\nBEGIN\n\n    CASE p_coderror\n        WHEN 1031 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: Privilegios insuficientes.');\n        WHEN 1017 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: Usuario o contrase\xf1a incorrectos.');\n        WHEN 1005 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: Contrase\xf1a dada nula; acceso denegado.');\n        WHEN 1045 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: Acceso denegado, no tiene privilegios de CREAR SESI\xd3N.');\n        WHEN 28001 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: Contrase\xf1a caducada.');\n        WHEN 28009 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: La conexi\xf3n como SYS debe ser como SYSDBA o SYSOPER.');\n        WHEN 28003 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: La verificaci\xf3n de la contrase\xf1a para la contrase\xf1a especificada fall\xf3.');\n        WHEN 2396 THEN\n            DBMS_OUTPUT.PUT_LINE('ERROR: Se ha excedido el tiempo m\xe1ximo de inactividad, por favor, conecte de nuevo.');\n        ELSE\n            DBMS_OUTPUT.PUT_LINE('ERROR: Error desconocido.');\n    END CASE;\nEND;\n/\n")),(0,i.kt)("p",null,"Creamos el segundo procedimiento que ser\xe1 una llamada al primero donde mostraremos el nombre del usuario, la fecha y hora en la que se ha producido el error y el error que se ha producido usando el procedimiento anterior, por lo que tendremos que realizar un cursor para recorrer la tabla y mostrar los datos:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE OR REPLACE PROCEDURE accesos_fallidos IS\n    CURSOR c_audit IS\n        SELECT username, returncode, substr(extended_timestamp, 1, 9) as fecha, substr(extended_timestamp, 10, 8) as hora\n        FROM dba_audit_session;\n\n    v_error c_audit%ROWTYPE;\n\nBEGIN\n\n    FOR v_error IN c_audit LOOP\n        DBMS_OUTPUT.PUT_LINE('!!ERROR DE ACCESO!!');\n        DBMS_OUTPUT.PUT_LINE('* Usuario: ' || v_error.username);\n        DBMS_OUTPUT.PUT_LINE('* Fecha: ' || v_error.fecha);\n        DBMS_OUTPUT.PUT_LINE('* Hora: ' || v_error.hora);\n        audit_error(v_error.returncode);\n        DBMS_OUTPUT.PUT_LINE('----------------------------------------');\n    END LOOP;\n\nEND;\n/\n")),(0,i.kt)("p",null,"Para probar el procedimiento vamos a intentar reproducir un error de acceso. Y luego ejecutamos el procedimiento accediendo como admin:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"exec accesos_fallidos;\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Auditoria",src:n(2522).Z,width:"625",height:"159"}),"\n",(0,i.kt)("img",{alt:"Auditoria",src:n(8774).Z,width:"420",height:"163"})),(0,i.kt)("h2",{id:"3-activa-la-auditor\xeda-de-las-operaciones-dml-realizadas-por-scott-comprueba-su-funcionamiento"},"3. Activa la auditor\xeda de las operaciones DML realizadas por SCOTT. Comprueba su funcionamiento."),(0,i.kt)("p",null,"En caso de no tener al usuario SCOTT creado, lo creamos y le damos permiso para trabajar sobre la tabla ",(0,i.kt)("inlineCode",{parentName:"p"},"emp")," y ",(0,i.kt)("inlineCode",{parentName:"p"},"dept"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE USER scott IDENTIFIED BY tiger;\nGRANT SELECT, INSERT, UPDATE, DELETE ON emp TO scott;\nGRANT SELECT, INSERT, UPDATE, DELETE ON dept TO scott;\n")),(0,i.kt)("p",null,"*Nota: si no deja crear el usuario, puede ser porque ya exista o porque no nos permita aun siendo administrador debido a permisos de seguridad o similar. ",(0,i.kt)("strong",{parentName:"p"},"No es recomendable")," pero podemos ejecutar ",(0,i.kt)("inlineCode",{parentName:"p"},'ALTER SESSION SET "_ORACLE_SCRIPT"=true;_')," para poder crear el usuario. Esto ",(0,i.kt)("strong",{parentName:"p"},"es una mala pr\xe1ctica")," y no se recomienda, ya que lo que hace es alterar la sesi\xf3n para que no se apliquen las restricciones de seguridad, por lo que ",(0,i.kt)("strong",{parentName:"p"},"puede ser peligroso.")),(0,i.kt)("p",null,"Lo siguiente ser\xe1 activar la auditor\xeda, para ello tenemos que ejecutar el siguiente comando:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"AUDIT INSERT TABLE, UPDATE TABLE, DELETE TABLE BY SCOTT;\n")),(0,i.kt)("p",null,"Y comprobamos que se ha activado correctamente trabajando sobre la tabla ",(0,i.kt)("inlineCode",{parentName:"p"},"emp")," de SCOTT:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"UPDATE emp SET ename = 'JUAN' WHERE empno = 7844;\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Auditoria",src:n(8817).Z,width:"361",height:"311"})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"DELETE FROM emp WHERE sal <= 950;\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Auditoria",src:n(2268).Z,width:"328",height:"323"})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO EMP VALUES(7900, 'JAMES', 'CLERK', 7698,TO_DATE('3-DIC-1981', 'DD-MON-YYYY'), 950, NULL, 30);\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Auditoria",src:n(5798).Z,width:"343",height:"324"})),(0,i.kt)("p",null,"Para poder visualizar la recolecci\xf3n de datos en la auditoria se consulta la tabla ",(0,i.kt)("inlineCode",{parentName:"p"},"DBA_AUDIT_OBJECT"),", esta tabla muestra registros de auditor\xeda para cada objeto de la base de datos que se ha auditado, en este enlace vemos m\xe1s informaci\xf3n sobre la misma: ",(0,i.kt)("a",{parentName:"p",href:"https://docs.oracle.com/cd/B13789_01/server.101/b10755/statviews_2047.htm"},"https://docs.oracle.com/cd/B13789_01/server.101/b10755/statviews_2047.htm")),(0,i.kt)("p",null,"Vamos a consultar el nombre de usuario, el nombre del objeto, el tipo de operaci\xf3n y la fecha y hora de la operaci\xf3n:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT USERNAME, OBJ_NAME, ACTION_NAME, EXTENDED_TIMESTAMP FROM DBA_AUDIT_OBJECT;\n")),(0,i.kt)("h2",{id:"4-realiza-una-auditor\xeda-de-grano-fino-para-almacenar-informaci\xf3n-sobre-la-inserci\xf3n-de-empleados-con-sueldo-superior-a-2000-en-la-tabla-emp-de-scott"},"4. Realiza una auditor\xeda de grano fino para almacenar informaci\xf3n sobre la inserci\xf3n de empleados con sueldo superior a 2000 en la tabla emp de scott."),(0,i.kt)("h2",{id:"5-explica-la-diferencia-entre-auditar-una-operaci\xf3n-by-access-o-by-session-ilustr\xe1ndolo-con-ejemplos"},"5. Explica la diferencia entre auditar una operaci\xf3n by access o by session ilustr\xe1ndolo con ejemplos."),(0,i.kt)("h2",{id:"6-documenta-las-diferencias-entre-los-valores-db-y-db-extended-del-par\xe1metro-audit_trail-de-oracle-demu\xe9stralas-poniendo-un-ejemplo-de-la-informaci\xf3n-sobre-una-operaci\xf3n-concreta-recopilada-con-cada-uno-de-ellos"},"6. Documenta las diferencias entre los valores db y db, extended del par\xe1metro audit_trail de ORACLE. Demu\xe9stralas poniendo un ejemplo de la informaci\xf3n sobre una operaci\xf3n concreta recopilada con cada uno de ellos."),(0,i.kt)("h2",{id:"7-averigua-si-en-postgres-se-pueden-realizar-los-cuatro-primeros-apartados-si-es-as\xed-documenta-el-proceso-adecuadamente"},"7. Averigua si en Postgres se pueden realizar los cuatro primeros apartados. Si es as\xed, documenta el proceso adecuadamente."),(0,i.kt)("h2",{id:"8-averigua-si-en-mysql-se-pueden-realizar-los-apartados-1-3-y-4-si-es-as\xed-documenta-el-proceso-adecuadamente"},"8. Averigua si en MySQL se pueden realizar los apartados 1, 3 y 4. Si es as\xed, documenta el proceso adecuadamente."),(0,i.kt)("h2",{id:"9-averigua-las-posibilidades-que-ofrece-mongodb-para-auditar-los-cambios-que-va-sufriendo-un-documento-demuestra-su-funcionamiento"},"9. Averigua las posibilidades que ofrece MongoDB para auditar los cambios que va sufriendo un documento. Demuestra su funcionamiento."),(0,i.kt)("h2",{id:"10-averigua-si-en-mongodb-se-pueden-auditar-los-accesos-a-una-colecci\xf3n-concreta-demuestra-su-funcionamiento"},"10. Averigua si en MongoDB se pueden auditar los accesos a una colecci\xf3n concreta. Demuestra su funcionamiento."),(0,i.kt)("p",null,"\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\ud83d\udc1a\u200a                 \ud83d\udc1a\u200a                    \ud83d\udc1a\u200a                     \ud83d\udc1a\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164\u3164"))}u.isMDXComponent=!0},5553:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-2-b13635199a1493363e405f5fdd48f441.png"},5214:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-3-daf4393fa968b747f209fb03ec228e5b.png"},2522:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-4-62efb7f43fbe2b258753d19ecc6b8942.png"},8774:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-5-23a4d175b40cfb2dcdc819bc401b2ef9.png"},8817:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-6-78c34ffec4b63718ae4b5ea9f8f06c39.png"},2268:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-7-6c3c0045daea86cc381a0b5fb7f5c1db.png"},5798:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-8-892280e0f28a75ab215a9490743d572c.png"},207:(e,a,n)=>{n.d(a,{Z:()=>o});const o=n.p+"assets/images/auditoria-6772e3cd858f68a09b13e90d03bd7e19.png"}}]);