"use strict";(self.webpackChunkotter_shell=self.webpackChunkotter_shell||[]).push([[8691],{3905:(e,a,n)=>{n.d(a,{Zo:()=>d,kt:()=>m});var r=n(7294);function t(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function o(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?o(Object(n),!0).forEach((function(a){t(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,r,t=function(e,a){if(null==e)return{};var n,r,t={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],a.indexOf(n)>=0||(t[n]=e[n]);return t}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var l=r.createContext({}),c=function(e){var a=r.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):i(i({},a),e)),n},d=function(e){var a=c(e.components);return r.createElement(l.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},p=r.forwardRef((function(e,a){var n=e.components,t=e.mdxType,o=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(n),m=t,b=p["".concat(l,".").concat(m)]||p[m]||u[m]||o;return n?r.createElement(b,i(i({ref:a},d),{},{components:n})):r.createElement(b,i({ref:a},d))}));function m(e,a){var n=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var o=n.length,i=new Array(o);i[0]=p;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s.mdxType="string"==typeof e?e:t,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},4704:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=n(7462),t=(n(7294),n(3905));const o={sidebar_position:14},i="Gesti\xf3n de redes en OpenStack",s={unversionedId:"Tasks/redes_openstack",id:"Tasks/redes_openstack",title:"Gesti\xf3n de redes en OpenStack",description:"Procedimientos",source:"@site/docs/Tasks/redes_openstack.md",sourceDirName:"Tasks",slug:"/Tasks/redes_openstack",permalink:"/docs/Tasks/redes_openstack",draft:!1,editUrl:"https://github.com/belennazareth/ottershell/blob/main/docs/Tasks/redes_openstack.md",tags:[],version:"current",sidebarPosition:14,frontMatter:{sidebar_position:14},sidebar:"tutorialSidebar",previous:{title:"Instalaci\xf3n de nginx con PHP",permalink:"/docs/Tasks/nginx_php"},next:{title:"Configuraci\xf3n Apache2 + fpm+php",permalink:"/docs/Tasks/apache2_fpm"}},l={},c=[{value:"Procedimientos",id:"procedimientos",level:2},{value:"2. Los comandos OSC y sus salidas, para visualizar las redes que tienes en tu proyecto y los routers.",id:"2-los-comandos-osc-y-sus-salidas-para-visualizar-las-redes-que-tienes-en-tu-proyecto-y-los-routers",level:3},{value:"3. Cuando crees la instancia maquina-router, accede a ella y comprueba la IP fija que ha tomando. Responde: \xbfHas podido a\xf1adir una IP flotante a esta nueva instancia? Razona la respuesta.",id:"3-cuando-crees-la-instancia-maquina-router-accede-a-ella-y-comprueba-la-ip-fija-que-ha-tomando-responde-has-podido-a\xf1adir-una-ip-flotante-a-esta-nueva-instancia-razona-la-respuesta",level:3},{value:"4. Comandos OSC para conectar la maquina-router a la red-interna y que tenga la direcci\xf3n 10.0.100.1.",id:"4-comandos-osc-para-conectar-la-maquina-router-a-la-red-interna-y-que-tenga-la-direcci\xf3n-1001001",level:3},{value:"5. Comandos OSC para crear la maquina-cliente con la direcci\xf3n 10.0.100.200. Responde: \xbfHas podido a\xf1adir una IP flotante a esta nueva instancia? Razona la respuesta.",id:"5-comandos-osc-para-crear-la-maquina-cliente-con-la-direcci\xf3n-100100200-responde-has-podido-a\xf1adir-una-ip-flotante-a-esta-nueva-instancia-razona-la-respuesta",level:3},{value:"6. Comandos OSC para deshabilitar la seguridad de los puertos de la red-interna.",id:"6-comandos-osc-para-deshabilitar-la-seguridad-de-los-puertos-de-la-red-interna",level:3},{value:"7. Comprobaci\xf3n de que la maquina-cliente tiene conexi\xf3n al exterior.",id:"7-comprobaci\xf3n-de-que-la-maquina-cliente-tiene-conexi\xf3n-al-exterior",level:3},{value:"8. Comprobaci\xf3n del acceso al servidor web de la maquina-cliente desde el exterior.",id:"8-comprobaci\xf3n-del-acceso-al-servidor-web-de-la-maquina-cliente-desde-el-exterior",level:3},{value:"Notas",id:"notas",level:2}],d={toc:c};function u(e){let{components:a,...o}=e;return(0,t.kt)("wrapper",(0,r.Z)({},d,o,{components:a,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"gesti\xf3n-de-redes-en-openstack"},"Gesti\xf3n de redes en OpenStack"),(0,t.kt)("h2",{id:"procedimientos"},"Procedimientos"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"Crea una nueva red (llamada red-externa) y una subred con DHCP, DNS el 192.168.202.2 y direccionamiento 192.168.0.0/24. Crea un nuevo router. Conecta la nueva red al router, y el router a red p\xfablica.")),(0,t.kt)("p",null,"Para una red:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"openstack network create red-externa\n\nopenstack subnet create --network red-externa --dhcp --dns-nameserver 192.168.202.2 --subnet-range 192.168.0.0/24 subred-externa\n")),(0,t.kt)("p",null,"Para crear un router:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"openstack router create routersin\n\nopenstack router set routersin --external-gateway ext-net\nopenstack router add subnet routersin subred-externa\n")),(0,t.kt)("ol",{start:2},(0,t.kt)("li",{parentName:"ol"},"Crea una instancia (llamada maquina-router) conectada a la nueva red. Comprueba que la IP fija est\xe1 en el direccionamiento de la nueva red. \xbfPuedes a\xf1adirle una IP flotante a la nueva instancia? \xbfPor qu\xe9?.")),(0,t.kt)("p",null,"Para crear la instancia:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},' openstack server create --flavor m1.mini \\\n --image "Debian 11 Bullseye" \\\n --security-group default \\\n --key-name nazareth_local \\\n --network red-externa \\\n maquina-router\n')),(0,t.kt)("p",null,"Para a\xf1adir la IP flotante:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"}," openstack floating ip create ext-net\n openstack server add floating ip  maquina-router {ip}\n")),(0,t.kt)("ol",{start:3},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},"Crea una nueva red (llamada red-interna) y una subred con DHCP, DNS el 192.168.202.2 y direccionamiento 10.0.100.0/24."),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"openstack network create red-interna --internal\n")))),(0,t.kt)("p",null,"openstack subnet create --network red-interna --dhcp --dns-nameserver 192.168.202.2 --subnet-range 10.0.100.0/24 subred-interna"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"\n\n4. Conecta la instancia maquina-router a la nueva red y as\xedgnale la primera direcci\xf3n: 10.0.100.1.\n\n\n5. Crea una instancia llamada maquina-cliente conectada a la red red-interna. Usando puertos de red as\xedgnale la direcci\xf3n 10.0.100.200. Comprueba que su puerta de enlace es la instancia maquina-router. \xbfPuedes asignarle a esta instancia una IP flotante? \xbfPor qu\xe9?.\n\n\n6. A continuaci\xf3n vamos a configurar la instancia maquina-router para que haga de router-nat. Sin embargo, las restricciones y la seguridad del cortafuegos que tenemos configurado en cada una de las interfaces de las instancias no van a permitir que funcione de forma adecuada. Por lo tanto, desactiva la seguridad de la interfaz de maquina-router y maquina-cliente conectadas a la red-interna.\n\n\n7. Configura la instancia maquina-router para que funcione como router-nat. Comprueba que el cliente tiene acceso a internet. Instala un servidor web en el cliente.\n\n\n8. Accede desde el exterior con un navegador web al servidor web del cliente.\n\n\n## Entrega\n\n### 1. Los comandos OSC para crear la red `red-externa`.\n\n```bash\nopenstack network create red-externa\n\nopenstack subnet create --network red-externa --dhcp --dns-nameserver 192.168.202.2 --subnet-range 192.168.0.0/24 subred-externa\n")),(0,t.kt)("h3",{id:"2-los-comandos-osc-y-sus-salidas-para-visualizar-las-redes-que-tienes-en-tu-proyecto-y-los-routers"},"2. Los comandos OSC y sus salidas, para visualizar las redes que tienes en tu proyecto y los routers."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"(RedLine)  nazare@ThousandSunny \ue0b0 ~$  openstack network list\n\n+--------------------------------------+--------------------------+--------------------------------------+\n| ID                                   | Name                     | Subnets                              |\n+--------------------------------------+--------------------------+--------------------------------------+\n| 2ebd4d15-00e3-44c6-a9a7-aeebef5f6540 | ext-net                  | fedce2ca-083e-4df8-bf1c-abbf4ab19cd1 |\n| 705f009c-06ec-4b44-82c9-8492713f0a1f | red de nazaret.duran     | c51bfa29-134c-4b8e-b1e0-e409a677cd56 |\n| 98c1cf52-b499-44fc-bcb1-47c1e1fc5872 | Red DMZ de nazaret.duran | 5c49862b-4cf8-4e18-af20-24a348692a10 |\n| fcfaba89-33f9-41f8-9971-72ac95435783 | red-externa              | ca685547-1fe3-41a4-bf5b-ce402f807abd |\n+--------------------------------------+--------------------------+--------------------------------------+\n\n(RedLine)  nazare@ThousandSunny \ue0b0 ~$  openstack subnet list\n\n+--------------------------------------+----------------+--------------------------------------+----------------+\n| ID                                   | Name           | Network                              | Subnet         |\n+--------------------------------------+----------------+--------------------------------------+----------------+\n| 5c49862b-4cf8-4e18-af20-24a348692a10 |                | 98c1cf52-b499-44fc-bcb1-47c1e1fc5872 | 172.16.0.0/16  |\n| c51bfa29-134c-4b8e-b1e0-e409a677cd56 |                | 705f009c-06ec-4b44-82c9-8492713f0a1f | 10.0.0.0/24    |\n| ca685547-1fe3-41a4-bf5b-ce402f807abd | subred-externa | fcfaba89-33f9-41f8-9971-72ac95435783 | 192.168.0.0/24 |\n+--------------------------------------+----------------+--------------------------------------+----------------+\n\n(RedLine)  nazare@ThousandSunny \ue0b0 ~$  openstack router list\n\n+--------------------------------------+-------------------------+--------+-------+----------------------------------+\n| ID                                   | Name                    | Status | State | Project                          |\n+--------------------------------------+-------------------------+--------+-------+----------------------------------+\n| e6dd515b-321f-431d-8a7f-55ce596a142e | routersin               | ACTIVE | UP    | cdb0ff7eeae74b1cbb06e4c476c52889 |\n| f3f45b48-ec65-4b7f-9e8e-f8034bff6b99 | router de nazaret.duran | ACTIVE | UP    | cdb0ff7eeae74b1cbb06e4c476c52889 |\n+--------------------------------------+-------------------------+--------+-------+----------------------------------+\n")),(0,t.kt)("h3",{id:"3-cuando-crees-la-instancia-maquina-router-accede-a-ella-y-comprueba-la-ip-fija-que-ha-tomando-responde-has-podido-a\xf1adir-una-ip-flotante-a-esta-nueva-instancia-razona-la-respuesta"},"3. Cuando crees la instancia maquina-router, accede a ella y comprueba la IP fija que ha tomando. Responde: \xbfHas podido a\xf1adir una IP flotante a esta nueva instancia? Razona la respuesta."),(0,t.kt)("p",null,"Como podemos comprobar se ha accedido a la m\xe1quina por la IP flotante que se le ha asignado, y si ejecutamos un ",(0,t.kt)("inlineCode",{parentName:"p"},"ip a")," veremos que la IP fija que ha tomado es de la red:  "),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Term",src:n(1658).Z,width:"944",height:"605"})),(0,t.kt)("p",null,"S\xed que se ha podido asignar una IP flotante a la instancia debido a que la red creada est\xe1 conectada por medio de un router a la red ext-net, la cual es la encargada de proporcionar las IP flotantes y asignarlas."),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Term",src:n(1806).Z,width:"865",height:"473"})),(0,t.kt)("h3",{id:"4-comandos-osc-para-conectar-la-maquina-router-a-la-red-interna-y-que-tenga-la-direcci\xf3n-1001001"},"4. Comandos OSC para conectar la maquina-router a la red-interna y que tenga la direcci\xf3n 10.0.100.1."),(0,t.kt)("p",null,"Lo primera ser\xe1 crear un puerto con la direcci\xf3n que se le quiere asignar a la m\xe1quina:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"openstack port create --network red-interna --fixed-ip ip-address=10.0.100.1 puertesito\n")),(0,t.kt)("p",null,"Para conectar la instancia ",(0,t.kt)("inlineCode",{parentName:"p"},"maquina-router")," a\xf1adimos el puerto creado:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"openstack server add port maquina-router puertesito\n")),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Term",src:n(7982).Z,width:"1628",height:"241"})),(0,t.kt)("h3",{id:"5-comandos-osc-para-crear-la-maquina-cliente-con-la-direcci\xf3n-100100200-responde-has-podido-a\xf1adir-una-ip-flotante-a-esta-nueva-instancia-razona-la-respuesta"},"5. Comandos OSC para crear la maquina-cliente con la direcci\xf3n 10.0.100.200. Responde: \xbfHas podido a\xf1adir una IP flotante a esta nueva instancia? Razona la respuesta."),(0,t.kt)("p",null,"Para crear la ",(0,t.kt)("inlineCode",{parentName:"p"},"maquina-cliente"),", primero es necesario crear un puerto con el que asignaremos la ip y despu\xe9s creamos la m\xe1quina usando la opci\xf3n ",(0,t.kt)("inlineCode",{parentName:"p"},"--port")," donde se le indica el puerto creado con la ip ",(0,t.kt)("inlineCode",{parentName:"p"},"10.0.100.200"),":"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'openstack port create --network red-interna --fixed-ip ip-address=10.0.100.200 puertete \n\nopenstack server create --flavor m1.mini \\\n--image "Debian 11 Bullseye" \\\n--security-group default \\\n--key-name nazareth_local \\\n--port puertete \\\nmaquina-cliente\n')),(0,t.kt)("p",null,"No se ha podido a\xf1adir una ip flotante ya que es una red interna y por lo tanto solo se puede acceder a esta por el router haciendo un puente:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"ssh -AJ debian@172.22.201.235 debian@10.0.100.200\n")),(0,t.kt)("p",null,"Como se puede comprobar se ha creado la m\xe1quina con ",(0,t.kt)("inlineCode",{parentName:"p"},"maquina-router")," como gateway:"),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Term",src:n(1729).Z,width:"1022",height:"746"})),(0,t.kt)("h3",{id:"6-comandos-osc-para-deshabilitar-la-seguridad-de-los-puertos-de-la-red-interna"},"6. Comandos OSC para deshabilitar la seguridad de los puertos de la red-interna."),(0,t.kt)("p",null,"Hay que deshabilitar la seguridad de los puertos de la maquina-router y de maquina-cliente, quitando primero los grupos de seguridad a ambas:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"openstack server remove security group maquina-router default\nopenstack server remove security group maquina-cliente default\n\nopenstack port set --disable-port-security puertete\n")),(0,t.kt)("h3",{id:"7-comprobaci\xf3n-de-que-la-maquina-cliente-tiene-conexi\xf3n-al-exterior"},"7. Comprobaci\xf3n de que la maquina-cliente tiene conexi\xf3n al exterior."),(0,t.kt)("p",null,"Primero hay que configurar la instancia maquina-router para que haga de router-nat:"),(0,t.kt)("h3",{id:"8-comprobaci\xf3n-del-acceso-al-servidor-web-de-la-maquina-cliente-desde-el-exterior"},"8. Comprobaci\xf3n del acceso al servidor web de la maquina-cliente desde el exterior."),(0,t.kt)("h2",{id:"notas"},"Notas"),(0,t.kt)("p",null,"Para poder acceder al entorno:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Primero ejecutamos el entorno virtual:"),(0,t.kt)("p",{parentName:"li"},"  source RedLine/bin/activate")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Luego dentro ejecutamos:"),(0,t.kt)("p",{parentName:"li"},"  source Proyecto\\ de\\ nazaret.duran-openrc.sh"))))}u.isMDXComponent=!0},1658:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/taller2SRI4-3-8354800bdf0675c1f0ad1db275fbfbc2.png"},1806:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/taller2SRI4-4-7933a1393654081a5c53d4993d8f963e.png"},7982:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/taller2SRI4-5-b553f1d5f0c317c7d37bb7b8f31f7966.png"},1729:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/taller2SRI4-6-ddf6f10bceb5a0676860aaf3b1c1170c.png"}}]);