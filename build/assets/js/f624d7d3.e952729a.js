"use strict";(self.webpackChunkotter_shell=self.webpackChunkotter_shell||[]).push([[1968],{3905:(e,n,a)=>{a.d(n,{Zo:()=>u,kt:()=>c});var o=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function s(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,o)}return a}function t(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?s(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function l(e,n){if(null==e)return{};var a,o,r=function(e,n){if(null==e)return{};var a,o,r={},s=Object.keys(e);for(o=0;o<s.length;o++)a=s[o],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)a=s[o],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=o.createContext({}),p=function(e){var n=o.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):t(t({},n),e)),a},u=function(e){var n=p(e.components);return o.createElement(i.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var a=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(a),c=r,b=d["".concat(i,".").concat(c)]||d[c]||m[c]||s;return a?o.createElement(b,t(t({ref:n},u),{},{components:a})):o.createElement(b,t({ref:n},u))}));function c(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=a.length,t=new Array(s);t[0]=d;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l.mdxType="string"==typeof e?e:r,t[1]=l;for(var p=2;p<s;p++)t[p]=a[p];return o.createElement.apply(null,t)}return o.createElement.apply(null,a)}d.displayName="MDXCreateElement"},4498:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>t,default:()=>m,frontMatter:()=>s,metadata:()=>l,toc:()=>p});var o=a(7462),r=(a(7294),a(3905));const s={sidebar_position:15},t="PRIMER BOLET\xcdN PL/SQL",l={unversionedId:"Tasks/plsql_basica",id:"Tasks/plsql_basica",title:"PRIMER BOLET\xcdN PL/SQL",description:"PL/SQL",source:"@site/docs/Tasks/plsql_basica.md",sourceDirName:"Tasks",slug:"/Tasks/plsql_basica",permalink:"/docs/Tasks/plsql_basica",draft:!1,editUrl:"https://github.com/belennazareth/ottershell/blob/main/docs/Tasks/plsql_basica.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{sidebar_position:15},sidebar:"tutorialSidebar",previous:{title:"Migraci\xf3n CentOS",permalink:"/docs/Tasks/migracion_centos"},next:{title:"Instalaci\xf3n de WordPress",permalink:"/docs/Tasks/wordpress"}},i={},p=[{value:"PL/SQL",id:"plsql",level:2},{value:"1. Hacer un procedimiento que muestre el nombre y el salario del empleado cuyo c\xf3digo es 7782",id:"1-hacer-un-procedimiento-que-muestre-el-nombre-y-el-salario-del-empleado-cuyo-c\xf3digo-es-7782",level:3},{value:"2. Hacer un procedimiento que reciba como par\xe1metro un c\xf3digo de empleado y devuelva su nombre",id:"2-hacer-un-procedimiento-que-reciba-como-par\xe1metro-un-c\xf3digo-de-empleado-y-devuelva-su-nombre",level:3},{value:"3. Hacer un procedimiento que devuelva los nombres de los tres empleados m\xe1s antiguos",id:"3-hacer-un-procedimiento-que-devuelva-los-nombres-de-los-tres-empleados-m\xe1s-antiguos",level:3},{value:"4. Hacer un procedimiento que reciba el nombre de un tablespace y muestre los nombres de los usuarios que lo tienen como tablespace por defecto (Vista DBA_USERS)",id:"4-hacer-un-procedimiento-que-reciba-el-nombre-de-un-tablespace-y-muestre-los-nombres-de-los-usuarios-que-lo-tienen-como-tablespace-por-defecto-vista-dba_users",level:3},{value:"5. Modificar el procedimiento anterior para que haga lo mismo pero devolviendo el n\xfamero de usuarios que tienen ese tablespace como tablespace por defecto. Nota: Hay que convertir el procedimiento en funci\xf3n",id:"5-modificar-el-procedimiento-anterior-para-que-haga-lo-mismo-pero-devolviendo-el-n\xfamero-de-usuarios-que-tienen-ese-tablespace-como-tablespace-por-defecto-nota-hay-que-convertir-el-procedimiento-en-funci\xf3n",level:3},{value:"6. Hacer un procedimiento llamado mostrar_usuarios_por_tablespace que muestre por pantalla un listado de los tablespaces existentes con la lista de usuarios de cada uno y el n\xfamero de los mismos, as\xed: (Vistas DBA_TABLESPACES y DBA_USERS)",id:"6-hacer-un-procedimiento-llamado-mostrar_usuarios_por_tablespace-que-muestre-por-pantalla-un-listado-de-los-tablespaces-existentes-con-la-lista-de-usuarios-de-cada-uno-y-el-n\xfamero-de-los-mismos-as\xed-vistas-dba_tablespaces-y-dba_users",level:3},{value:"7. Hacer un procedimiento llamado mostrar_codigo_fuente  que reciba el nombre de otro procedimiento y muestre su c\xf3digo fuente. (DBA_SOURCE)",id:"7-hacer-un-procedimiento-llamado-mostrar_codigo_fuente--que-reciba-el-nombre-de-otro-procedimiento-y-muestre-su-c\xf3digo-fuente-dba_source",level:3},{value:"8. Hacer un procedimiento llamado mostrar_privilegios_usuario que reciba el nombre de un usuario y muestre sus privilegios de sistema y sus privilegios sobre objetos. (DBA_SYS_PRIVS y DBA_TAB_PRIVS)",id:"8-hacer-un-procedimiento-llamado-mostrar_privilegios_usuario-que-reciba-el-nombre-de-un-usuario-y-muestre-sus-privilegios-de-sistema-y-sus-privilegios-sobre-objetos-dba_sys_privs-y-dba_tab_privs",level:3},{value:"9. Realiza un procedimiento llamado listar_comisiones que nos muestre por pantalla un listado de las comisiones de los empleados agrupados seg\xfan la localidad donde est\xe1 ubicado su departamento con el siguiente formato:",id:"9-realiza-un-procedimiento-llamado-listar_comisiones-que-nos-muestre-por-pantalla-un-listado-de-las-comisiones-de-los-empleados-agrupados-seg\xfan-la-localidad-donde-est\xe1-ubicado-su-departamento-con-el-siguiente-formato",level:3},{value:"10. Realiza un procedimiento que reciba el nombre de una tabla y muestre los nombres de las restricciones que tiene, a qu\xe9 columna afectan y en qu\xe9 consisten exactamente. (DBA_TABLES, DBA_CONSTRAINTS, DBA_CONS_COLUMNS)",id:"10-realiza-un-procedimiento-que-reciba-el-nombre-de-una-tabla-y-muestre-los-nombres-de-las-restricciones-que-tiene-a-qu\xe9-columna-afectan-y-en-qu\xe9-consisten-exactamente-dba_tables-dba_constraints-dba_cons_columns",level:3},{value:"PL/PgSQL",id:"plpgsql",level:2},{value:"11.1. Hacer un procedimiento que muestre el nombre y el salario del empleado cuyo c\xf3digo es 7782 usando PL/pgSQL.",id:"111-hacer-un-procedimiento-que-muestre-el-nombre-y-el-salario-del-empleado-cuyo-c\xf3digo-es-7782-usando-plpgsql",level:3},{value:"11.2. Hacer un procedimiento que reciba como par\xe1metro un c\xf3digo de empleado y devuelva su nombre usando PL/pgSQL.",id:"112-hacer-un-procedimiento-que-reciba-como-par\xe1metro-un-c\xf3digo-de-empleado-y-devuelva-su-nombre-usando-plpgsql",level:3}],u={toc:p};function m(e){let{components:n,...s}=e;return(0,r.kt)("wrapper",(0,o.Z)({},u,s,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"primer-bolet\xedn-plsql"},"PRIMER BOLET\xcdN PL/SQL"),(0,r.kt)("h2",{id:"plsql"},"PL/SQL"),(0,r.kt)("p",null,"Seg\xfan el esquema Scott, hacer los siguientes procedimientos:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE DEPT\n(\n DEPTNO NUMBER(2),\n DNAME VARCHAR2(14),\n LOC VARCHAR2(13),\n CONSTRAINT PK_DEPT PRIMARY KEY (DEPTNO)\n);\n\nCREATE TABLE EMP\n(\n EMPNO NUMBER(4),\n ENAME VARCHAR2(10),\n JOB VARCHAR2(9),\n MGR NUMBER(4),\n HIREDATE DATE,\n SAL NUMBER(7, 2),\n COMM NUMBER(7, 2),\n DEPTNO NUMBER(2),\n CONSTRAINT FK_DEPTNO FOREIGN KEY (DEPTNO) REFERENCES DEPT (DEPTNO),\n CONSTRAINT PK_EMP PRIMARY KEY (EMPNO)\n);\n\nINSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK');\nINSERT INTO DEPT VALUES (20, 'RESEARCH', 'DALLAS');\nINSERT INTO DEPT VALUES (30, 'SALES', 'CHICAGO');\nINSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON');\n\nINSERT INTO EMP VALUES(7369, 'SMITH', 'CLERK', 7902,TO_DATE('17-DIC-1980', 'DD-MON-YYYY'), 800, NULL, 20);\nINSERT INTO EMP VALUES(7499, 'ALLEN', 'SALESMAN', 7698,TO_DATE('20-FEB-1981', 'DD-MON-YYYY'), 1600, 300, 30);\nINSERT INTO EMP VALUES(7521, 'WARD', 'SALESMAN', 7698,TO_DATE('22-FEB-1981', 'DD-MON-YYYY'), 1250, 500, 30);\nINSERT INTO EMP VALUES(7566, 'JONES', 'MANAGER', 7839,TO_DATE('2-ABR-1981', 'DD-MON-YYYY'), 2975, NULL, 20);\nINSERT INTO EMP VALUES(7654, 'MARTIN', 'SALESMAN', 7698,TO_DATE('28-SEP-1981', 'DD-MON-YYYY'), 1250, 1400, 30);\nINSERT INTO EMP VALUES(7698, 'BLAKE', 'MANAGER', 7839,TO_DATE('1-MAY-1981', 'DD-MON-YYYY'), 2850, NULL, 30);\nINSERT INTO EMP VALUES(7782, 'CLARK', 'MANAGER', 7839,TO_DATE('9-JUN-1981', 'DD-MON-YYYY'), 2450, NULL, 10);\nINSERT INTO EMP VALUES(7788, 'SCOTT', 'ANALYST', 7566,TO_DATE('09-DIC-1982', 'DD-MON-YYYY'), 3000, NULL, 20);\nINSERT INTO EMP VALUES(7839, 'KING', 'PRESIDENT', NULL,TO_DATE('17-NOV-1981', 'DD-MON-YYYY'), 5000, NULL, 10);\nINSERT INTO EMP VALUES(7844, 'TURNER', 'SALESMAN', 7698,TO_DATE('8-SEP-1981', 'DD-MON-YYYY'), 1500, 0, 30);\nINSERT INTO EMP VALUES(7876, 'ADAMS', 'CLERK', 7788,TO_DATE('12-ENE-1983', 'DD-MON-YYYY'), 1100, NULL, 20);\nINSERT INTO EMP VALUES(7900, 'JAMES', 'CLERK', 7698,TO_DATE('3-DIC-1981', 'DD-MON-YYYY'), 950, NULL, 30);\nINSERT INTO EMP VALUES(7902, 'FORD', 'ANALYST', 7566,TO_DATE('3-DIC-1981', 'DD-MON-YYYY'), 3000, NULL, 20);\nINSERT INTO EMP VALUES(7934, 'MILLER', 'CLERK', 7782,TO_DATE('23-ENE-1982', 'DD-MON-YYYY'), 1300, NULL, 10);\n")),(0,r.kt)("p",null,"*",(0,r.kt)("strong",{parentName:"p"},"* Lo primero sera ejecutar el siguiente comando ",(0,r.kt)("inlineCode",{parentName:"strong"},"'set serveroutput on'"),", adem\xe1s de ",(0,r.kt)("inlineCode",{parentName:"strong"},"'startup'")," para arrancar el servicio de oracle. **")),(0,r.kt)("h3",{id:"1-hacer-un-procedimiento-que-muestre-el-nombre-y-el-salario-del-empleado-cuyo-c\xf3digo-es-7782"},"1. Hacer un procedimiento que muestre el nombre y el salario del empleado cuyo c\xf3digo es 7782"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure mostrar_sal_empleado \nas\n    v_nombre emp.ename%type;\n    v_sal emp.sal%type;\n\nbegin\n\n    select ename, sal into v_nombre, v_sal\n    from emp\n    where empno = 7782;\n    dbms_output.put_line('Nombre: ' || v_nombre);\n    dbms_output.put_line('Salario: ' || v_sal);\n\nexception\n    when no_data_found then\n        dbms_output.put_line('No se ha encontrado el empleado');\nend;\n/\n\nexec mostrar_sal_empleado;\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(8823).Z,width:"462",height:"178"})),(0,r.kt)("h3",{id:"2-hacer-un-procedimiento-que-reciba-como-par\xe1metro-un-c\xf3digo-de-empleado-y-devuelva-su-nombre"},"2. Hacer un procedimiento que reciba como par\xe1metro un c\xf3digo de empleado y devuelva su nombre"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure mostrar_ename (p_empno emp.empno%type) \nas \n    v_nombre emp.ename%type;\n\nbegin\n\n    select ename into v_nombre\n    from emp\n    where empno = p_empno;\n    dbms_output.put_line('Nombre: ' || v_nombre);\n\nexception\n    when no_data_found then\n        dbms_output.put_line('No se ha encontrado el empleado');\nend;\n/\n\nexec mostrar_ename(7566);\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(6728).Z,width:"469",height:"274"})),(0,r.kt)("h3",{id:"3-hacer-un-procedimiento-que-devuelva-los-nombres-de-los-tres-empleados-m\xe1s-antiguos"},"3. Hacer un procedimiento que devuelva los nombres de los tres empleados m\xe1s antiguos"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure emp_mas_antiguos\nas\n    cursor c_emp_antiguos is\n        select ename\n        from emp\n        order by hiredate\n        fetch first 3 rows only;\n\n    v_nombre emp.ename%type;\n\nbegin\n\n    dbms_output.put_line('Nombres:');\n    for v_nombre in c_emp_antiguos \n    loop\n        dbms_output.put_line(v_nombre.ename);\n    end loop;\nend;\n/\n\nexec emp_mas_antiguos;\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(6069).Z,width:"466",height:"228"})),(0,r.kt)("h3",{id:"4-hacer-un-procedimiento-que-reciba-el-nombre-de-un-tablespace-y-muestre-los-nombres-de-los-usuarios-que-lo-tienen-como-tablespace-por-defecto-vista-dba_users"},"4. Hacer un procedimiento que reciba el nombre de un tablespace y muestre los nombres de los usuarios que lo tienen como tablespace por defecto (Vista DBA_USERS)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure usuarios_tablespace (p_tablespace dba_users.default_tablespace%type)\nas\n    cursor c_usuarios_tablespace is\n        select username\n        from dba_users\n        where default_tablespace = p_tablespace;\n\n    v_nombre dba_users.username%type;\n\nbegin\n    \n        dbms_output.put_line('Nombres para este tablespace:');\n        for v_nombre in c_usuarios_tablespace \n        loop\n            dbms_output.put_line(v_nombre.username);\n        end loop;\n\nend;\n/\n\nexec usuarios_tablespace('USERS');\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(8219).Z,width:"456",height:"560"})),(0,r.kt)("h3",{id:"5-modificar-el-procedimiento-anterior-para-que-haga-lo-mismo-pero-devolviendo-el-n\xfamero-de-usuarios-que-tienen-ese-tablespace-como-tablespace-por-defecto-nota-hay-que-convertir-el-procedimiento-en-funci\xf3n"},"5. Modificar el procedimiento anterior para que haga lo mismo pero devolviendo el n\xfamero de usuarios que tienen ese tablespace como tablespace por defecto. Nota: Hay que convertir el procedimiento en funci\xf3n"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace function function_usuarios_tablespace (p_tablespace dba_users.default_tablespace%type) return number\nas\n    v_number number;\n\nbegin\n\n    select count(username) into v_number\n    from dba_users\n    where default_tablespace = p_tablespace;\n    return v_number;\n\nend;\n/\n\nselect function_usuarios_tablespace('USERS') from dual;\nselect function_usuarios_tablespace('SYSTEM') from dual;\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(4304).Z,width:"613",height:"338"})),(0,r.kt)("h3",{id:"6-hacer-un-procedimiento-llamado-mostrar_usuarios_por_tablespace-que-muestre-por-pantalla-un-listado-de-los-tablespaces-existentes-con-la-lista-de-usuarios-de-cada-uno-y-el-n\xfamero-de-los-mismos-as\xed-vistas-dba_tablespaces-y-dba_users"},"6. Hacer un procedimiento llamado mostrar_usuarios_por_tablespace que muestre por pantalla un listado de los tablespaces existentes con la lista de usuarios de cada uno y el n\xfamero de los mismos, as\xed: (Vistas DBA_TABLESPACES y DBA_USERS)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Tablespace xxxx:\n\n    Usr1\n    Usr2\n    ...\n\nTotal Usuarios Tablespace xxxx: n1\n\nTablespace yyyy:\n\n    Usr1\n    Usr2\n    ...\n\nTotal Usuarios Tablespace yyyy: n2\n....\nTotal Usuarios BD: nn\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"\ncreate or replace procedure listar_tablespace (p_tablespace dba_users.default_tablespace%type)\n\n\n\n")),(0,r.kt)("h3",{id:"7-hacer-un-procedimiento-llamado-mostrar_codigo_fuente--que-reciba-el-nombre-de-otro-procedimiento-y-muestre-su-c\xf3digo-fuente-dba_source"},"7. Hacer un procedimiento llamado mostrar_codigo_fuente  que reciba el nombre de otro procedimiento y muestre su c\xf3digo fuente. (DBA_SOURCE)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure mostrar_codigo_fuente (p_proc_name dba_source.name%type)\nis\n    cursor c_codigo is\n        select text\n        from dba_source\n        where name = p_proc_name;\n\nbegin\n\n    for v_text in c_codigo\n    loop\n        dbms_output.put_line(v_text.text);\n    end loop;\n\nend;\n/\n\nexec mostrar_codigo_fuente('USUARIOS_TABLESPACE');\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"NOTA: El nombre del procedimiento debe ser en may\xfasculas, ya que en la vista DBA_SOURCE est\xe1 en may\xfasculas. Si no, no lo encuentra. ")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(3391).Z,width:"787",height:"926"})),(0,r.kt)("h3",{id:"8-hacer-un-procedimiento-llamado-mostrar_privilegios_usuario-que-reciba-el-nombre-de-un-usuario-y-muestre-sus-privilegios-de-sistema-y-sus-privilegios-sobre-objetos-dba_sys_privs-y-dba_tab_privs"},"8. Hacer un procedimiento llamado mostrar_privilegios_usuario que reciba el nombre de un usuario y muestre sus privilegios de sistema y sus privilegios sobre objetos. (DBA_SYS_PRIVS y DBA_TAB_PRIVS)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure mostrar_privilegios_usuario (p_username dba_sys_privs.grantee%type)\nis\n    cursor c_privilegios is\n        select privilege\n        from dba_sys_privs\n        where grantee = p_username;\n\n    cursor c_privilegios_objetos is\n        select privilege\n        from dba_tab_privs\n        where grantee = p_username;\n\n    v_privilegio dba_sys_privs.privilege%type;\n\nbegin\n\n    dbms_output.put_line('Privilegios de sistema:');\n    for v_privilegio in c_privilegios\n    loop\n        dbms_output.put_line(v_privilegio.privilege);\n    end loop;\n\n    dbms_output.put_line('Privilegios sobre objetos:');\n    for v_privilegio in c_privilegios_objetos\n    loop\n        dbms_output.put_line(v_privilegio.privilege);\n    end loop;\n\nend;\n/\n\nexec mostrar_privilegios_usuario('SYSTEM');\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(8331).Z,width:"491",height:"392"})),(0,r.kt)("h3",{id:"9-realiza-un-procedimiento-llamado-listar_comisiones-que-nos-muestre-por-pantalla-un-listado-de-las-comisiones-de-los-empleados-agrupados-seg\xfan-la-localidad-donde-est\xe1-ubicado-su-departamento-con-el-siguiente-formato"},"9. Realiza un procedimiento llamado listar_comisiones que nos muestre por pantalla un listado de las comisiones de los empleados agrupados seg\xfan la localidad donde est\xe1 ubicado su departamento con el siguiente formato:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Localidad NombreLocalidad\n\nDepartamento: NombreDepartamento\n\n        Empleado1 \u2026\u2026. Comisi\xf3n 1\n        Empleado2 \u2026\u2026. Comisi\xf3n 2\n        .   \n        .\n        .\n        Empleadon \u2026\u2026. Comision n\n\n    Total Comisiones en el Departamento NombreDepartamento: SumaComisiones\n\n    Departamento: NombreDepartamento\n\n        Empleado1 \u2026\u2026. Comisi\xf3n 1\n        Empleado2 \u2026\u2026. Comisi\xf3n 2\n        .   \n        .       .\n        Empleadon \u2026\u2026. Comision n\n\n    Total Comisiones en el Departamento NombreDepartamento: SumaComisiones\n    .   \n    .\nTotal Comisiones en la Localidad NombreLocalidad: SumaComisionesLocalidad\n\nLocalidad NombreLocalidad\n.\n.\n\nTotal Comisiones en la Empresa: TotalComisiones\n")),(0,r.kt)("p",null,"Nota: Los nombres de localidades, departamentos y empleados deben aparecer por orden alfab\xe9tico."),(0,r.kt)("p",null,"Si alguno de los departamentos no tiene ning\xfan empleado con comisiones, aparecer\xe1 un mensaje informando de ello en lugar de la lista de empleados."),(0,r.kt)("p",null,"El procedimiento debe gestionar adecuadamente las siguientes excepciones:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"a) La tabla Empleados est\xe1 vac\xeda.\nb) Alguna comisi\xf3n es mayor que 10000.\n")),(0,r.kt)("h3",{id:"10-realiza-un-procedimiento-que-reciba-el-nombre-de-una-tabla-y-muestre-los-nombres-de-las-restricciones-que-tiene-a-qu\xe9-columna-afectan-y-en-qu\xe9-consisten-exactamente-dba_tables-dba_constraints-dba_cons_columns"},"10. Realiza un procedimiento que reciba el nombre de una tabla y muestre los nombres de las restricciones que tiene, a qu\xe9 columna afectan y en qu\xe9 consisten exactamente. (DBA_TABLES, DBA_CONSTRAINTS, DBA_CONS_COLUMNS)"),(0,r.kt)("h2",{id:"plpgsql"},"PL/PgSQL"),(0,r.kt)("p",null,"Para los siguientes apartados se ha usado ",(0,r.kt)("strong",{parentName:"p"},"postgresql")," creando la siguiente base de datos:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create table dept (\n  deptno integer,\n  dname  text,\n  loc    text,\n  constraint pk_dept primary key (deptno)\n);\n\ncreate table emp (\n  empno    integer,\n  ename    text,\n  job      text,\n  mgr      integer,\n  hiredate date,\n  sal      integer,\n  comm     integer,\n  deptno   integer,\n  constraint pk_emp primary key (empno),\n  constraint fk_mgr foreign key (mgr) references emp (empno),\n  constraint fk_deptno foreign key (deptno) references dept (deptno)\n);\n\ninsert into dept (deptno,  dname,        loc)\n       values    (10,     'ACCOUNTING', 'NEW YORK'),\n                 (20,     'RESEARCH',   'DALLAS'),\n                 (30,     'SALES',      'CHICAGO'),\n                 (40,     'OPERATIONS', 'BOSTON');\n\ninsert into emp (empno, ename,    job,        mgr,   hiredate,     sal, comm, deptno)\n       values   (7369, 'SMITH',  'CLERK',     7902, '1980-12-17',  800, NULL,   20),\n                (7499, 'ALLEN',  'SALESMAN',  7698, '1981-02-20', 1600,  300,   30),\n                (7521, 'WARD',   'SALESMAN',  7698, '1981-02-22', 1250,  500,   30),\n                (7566, 'JONES',  'MANAGER',   7839, '1981-04-02', 2975, NULL,   20),\n                (7654, 'MARTIN', 'SALESMAN',  7698, '1981-09-28', 1250, 1400,   30),\n                (7698, 'BLAKE',  'MANAGER',   7839, '1981-05-01', 2850, NULL,   30),\n                (7782, 'CLARK',  'MANAGER',   7839, '1981-06-09', 2450, NULL,   10),\n                (7788, 'SCOTT',  'ANALYST',   7566, '1982-12-09', 3000, NULL,   20),\n                (7839, 'KING',   'PRESIDENT', NULL, '1981-11-17', 5000, NULL,   10),\n                (7844, 'TURNER', 'SALESMAN',  7698, '1981-09-08', 1500,    0,   30),\n                (7876, 'ADAMS',  'CLERK',     7788, '1983-01-12', 1100, NULL,   20),\n                (7900, 'JAMES',  'CLERK',     7698, '1981-12-03',  950, NULL,   30),\n                (7902, 'FORD',   'ANALYST',   7566, '1981-12-03', 3000, NULL,   20),\n                (7934, 'MILLER', 'CLERK',     7782, '1982-01-23', 1300, NULL,   10);\n")),(0,r.kt)("h3",{id:"111-hacer-un-procedimiento-que-muestre-el-nombre-y-el-salario-del-empleado-cuyo-c\xf3digo-es-7782-usando-plpgsql"},"11.1. Hacer un procedimiento que muestre el nombre y el salario del empleado cuyo c\xf3digo es 7782 usando PL/pgSQL."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure mostrar_sal_empleado_pg (p_emp_no integer)\nlanguage plpgsql\nas $$\ndeclare\n\n    v_salario integer;\n    v_nombre text;\n\nbegin\n    \n        select sal, ename into v_salario, v_nombre from emp where empno = p_emp_no;\n    \n        raise notice 'El salario del empleado % es %', v_nombre, v_salario;\n    \nend; $$;\n\ncall mostrar_sal_empleado_pg(7782);\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(8528).Z,width:"468",height:"92"})),(0,r.kt)("h3",{id:"112-hacer-un-procedimiento-que-reciba-como-par\xe1metro-un-c\xf3digo-de-empleado-y-devuelva-su-nombre-usando-plpgsql"},"11.2. Hacer un procedimiento que reciba como par\xe1metro un c\xf3digo de empleado y devuelva su nombre usando PL/pgSQL."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"create or replace procedure mostrar_ename_pg (p_emp_no integer)\nlanguage plpgsql\nas $$\ndeclare\n\n    v_nombre text;\n\nbegin\n    \n        select ename into v_nombre from emp where empno = p_emp_no;\n    \n        raise notice 'El nombre del empleado % es %', p_emp_no, v_nombre;\n\nend; $$;\n\ncall mostrar_ename_pg (7566);\n")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"img",src:a(3167).Z,width:"462",height:"97"})))}m.isMDXComponent=!0},6728:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-2-ae0d977d1f6a8e664b46593b9d3be102.png"},6069:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-3-eebcfe04c1f760cf373979d557d2ef68.png"},8219:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-4-42581365006a974ff611a788b161bc16.png"},4304:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-5-c9785fcba2bd54c91d49083df36ab350.png"},8528:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-6-f9dba6b9778279f0133415bb998e8d48.png"},3167:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-7-2c5be85908d64eed1a09a15964eedfca.png"},3391:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-8-8c0b322b371a64cc583d532ac6354d9d.png"},8331:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-9-e416106bd7d6f5454128c9dae341facc.png"},8823:(e,n,a)=>{a.d(n,{Z:()=>o});const o=a.p+"assets/images/plsql-a2b5a8cd73e4d3d5f036b5085ef18a72.png"}}]);