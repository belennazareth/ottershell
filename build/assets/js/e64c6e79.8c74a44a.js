"use strict";(self.webpackChunkotter_shell=self.webpackChunkotter_shell||[]).push([[7468],{3905:(e,a,r)=>{r.d(a,{Zo:()=>c,kt:()=>p});var n=r(7294);function t(e,a,r){return a in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function o(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?o(Object(r),!0).forEach((function(a){t(e,a,r[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))}))}return e}function l(e,a){if(null==e)return{};var r,n,t=function(e,a){if(null==e)return{};var r,n,t={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],a.indexOf(r)>=0||(t[r]=e[r]);return t}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],a.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var s=n.createContext({}),d=function(e){var a=n.useContext(s),r=a;return e&&(r="function"==typeof e?e(a):i(i({},a),e)),r},c=function(e){var a=d(e.components);return n.createElement(s.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var r=e.components,t=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(r),p=t,b=u["".concat(s,".").concat(p)]||u[p]||m[p]||o;return r?n.createElement(b,i(i({ref:a},c),{},{components:r})):n.createElement(b,i({ref:a},c))}));function p(e,a){var r=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var o=r.length,i=new Array(o);i[0]=u;var l={};for(var s in a)hasOwnProperty.call(a,s)&&(l[s]=a[s]);l.originalType=e,l.mdxType="string"==typeof e?e:t,i[1]=l;for(var d=2;d<o;d++)i[d]=r[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},5004:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var n=r(7462),t=(r(7294),r(3905));const o={sidebar_position:29},i="Delegaci\xf3n de subdominios con bind9",l={unversionedId:"Tasks/bind9_subdominios",id:"Tasks/bind9_subdominios",title:"Delegaci\xf3n de subdominios con bind9",description:"| IPs |",source:"@site/docs/Tasks/bind9_subdominios.md",sourceDirName:"Tasks",slug:"/Tasks/bind9_subdominios",permalink:"/docs/Tasks/bind9_subdominios",draft:!1,editUrl:"https://github.com/belennazareth/ottershell/blob/main/docs/Tasks/bind9_subdominios.md",tags:[],version:"current",sidebarPosition:29,frontMatter:{sidebar_position:29},sidebar:"tutorialSidebar",previous:{title:"Auditor\xeda",permalink:"/docs/Tasks/auditorias"},next:{title:"Configuraci\xf3n de un servidor Apache2",permalink:"/docs/Tasks/configuracion_apache2"}},s={},d=[],c={toc:d};function m(e){let{components:a,...r}=e;return(0,t.kt)("wrapper",(0,n.Z)({},c,r,{components:a,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"delegaci\xf3n-de-subdominios-con-bind9"},"Delegaci\xf3n de subdominios con bind9"),(0,t.kt)("h1",{id:"procedimiento"},"Procedimiento"),(0,t.kt)("hr",null),(0,t.kt)("table",null,(0,t.kt)("thead",{parentName:"table"},(0,t.kt)("tr",{parentName:"thead"},(0,t.kt)("th",{parentName:"tr",align:"center"},"IPs"))),(0,t.kt)("tbody",{parentName:"table"},(0,t.kt)("tr",{parentName:"tbody"},(0,t.kt)("td",{parentName:"tr",align:"center"},"Servidor: 172.22.5.136")),(0,t.kt)("tr",{parentName:"tbody"},(0,t.kt)("td",{parentName:"tr",align:"center"},"Cliente: 172.22.1.35")),(0,t.kt)("tr",{parentName:"tbody"},(0,t.kt)("td",{parentName:"tr",align:"center"},"Esclavo: 172.22.4.145")),(0,t.kt)("tr",{parentName:"tbody"},(0,t.kt)("td",{parentName:"tr",align:"center"},"Delegado: 172.22.2.233")))),(0,t.kt)("hr",null),(0,t.kt)("p",null,"1.- Crea una nueva m\xe1quina e instala un servidor DNS bind9, ser\xe1 el servidor DNS con autoridad para la zona delegada que ser\xe1 informatica.tunombre.org. Nombra de manera adecuada esta m\xe1quina para que tenga el nombre dns.informatica.tunombre.org. Voy a suponer que la direcci\xf3n de esta nueva m\xe1quina es la 172.22.200.120."),(0,t.kt)("p",null,"Para esto ejecutamos el siguiente comando:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"sudo hostnamectl set-hostname dns\n")),(0,t.kt)("p",null,"Y editamos el fichero /etc/hosts para que tenga el nombre dns2.tunombre.org:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"127.0.1.1 dns.informatica.nazareth.org dns\n")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Tendremos el servidor dns1.tunombre.org (y el esclavo dns2.tunombre.org) con autoridad para la zona tunombre.org. En esta zona, por ejemplo, puede existir el nombre ",(0,t.kt)("a",{parentName:"li",href:"http://www.tunombre.org."},"www.tunombre.org.")," ",(0,t.kt)("inlineCode",{parentName:"li"},"(El fichero /etc/bind/named.conf.local del servidor es el que se encarga de indicar que zonas son administradas por el servidor. En este fichero debe existir una l\xednea que indique que el servidor es el autoritativo de la zona tunombre.org. Dentro se indica el fichero de configuraci\xf3n de la zona, en este caso /var/cache/bind/db.tunombre.org.)"))),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Tendremos el servidor dns.informatica.tunombre.org con autoridad sobre el subdominio delegado, es decir tendr\xe1 autoridad para la zona informatica.tunombre.org. En esta zona, por ejemplo, puede existir el nombre ",(0,t.kt)("a",{parentName:"li",href:"http://www.informatica.tunombre.org"},"www.informatica.tunombre.org"),".")),(0,t.kt)("p",null,"Para esto tenemos que modificar el fichero /etc/bind/named.conf.local y a\xf1adir la IP del servidor DNS con autoridad para la zona delegado en el apartado ",(0,t.kt)("inlineCode",{parentName:"p"},"allow-transfer"),", adem\xe1s en el fichero /var/cache/bind/db.tunombre.org "),(0,t.kt)("p",null,"2.- Vamos a realizar la delegaci\xf3n de autoridad para el subdominio en el servidor DNS principal (en dns1.tunombre.org) para ello modificamos el fichero /var/cache/bind/db.tunombre.org a\xf1adiendo las siguientes l\xedneas donde realizamos la delegaci\xf3n:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"}," ...\n$ORIGIN informatica.nazareth.org.\n@         IN     NS     dns\ndns     IN   A      172.22.2.233\n")),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"El par\xe1metro $ORIGIN nos permite usar nombres no cualificados totalmente.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Indicamos que el servidor con autoridad para la zona informatica.tunombre.org (registro NS), es dns.informatica.tunombre.org.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Y se indica la direcci\xf3n IP del servidor DNS.")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},"Si incrementas el n\xfamero de serie la delegaci\xf3n que hemos realizado se transferir\xe1 al servidor DNS esclavo."))),(0,t.kt)("p",null,"3.- Ahora vamos a configurar el servidor DNS delegado. Por lo tanto en el servidor dns.informatica.tunombre.org creamos una nueva zona en el fichero /etc/bind/named.conf.local:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},'zone "informatica.tunombre.org" {\n    type master;\n    file "db.informatica.tunombre.org";\n};\n')),(0,t.kt)("p",null,"Y creamos la zona en el fichero db.informatica.tunombre.org: (",(0,t.kt)("inlineCode",{parentName:"p"},"/var/cache/bind/db.informatica.nazareth.org"),")"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$TTL    86400\n@       IN      SOA     dns.informatica.tunombre.org. root.informatica.tunombre.org. (\n                              1         ; Serial\n                         604800         ; Refresh\n                          86400         ; Retry\n                        2419200         ; Expire\n                          86400 )       ; Negative Cache TTL\n;\n@   IN  NS      dns.informatica.tunombre.org.\n@   IN  MX  10  mail.informatica.tunombre.org.\n\n$ORIGIN informatica.tunombre.org.\n\ndns         IN  A       172.22.200.120\nmail        IN  A       172.22.200.121 \nweb         IN  A   172.22.200.122\nwww         IN  CNAME       web\n...\n")),(0,t.kt)("p",null,"De tal manera que quede:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"$TTL    86400\n@       IN      SOA     dns.informatica.nazareth.org. root.informatica.nazareth.org. (\n                              1         ; Serial\n                         604800         ; Refresh\n                          86400         ; Retry\n                        2419200         ; Expire\n                          86400 )       ; Negative Cache TTL\n;\n@   IN  NS      dns.informatica.nazareth.org.\n@   IN  MX  10  mail.informatica.nazareth.org.\n\n$ORIGIN informatica.nazareth.org.\n\ndns         IN  A             172.22.2.233\nmail        IN  A             172.22.200.121 \nweb         IN  A         172.22.200.122\nwww         IN  CNAME       web\n...\n")),(0,t.kt)("p",null,"4.- No modifiques el fichero /etc/resolv.conf del cliente, es decir, las consultas se hacen al servidor DNS principal, cuando preguntemos por un nombre en la zona delegada el servidor DNS principal, preguntar\xe1 al servidor DNS delegado y guardara la respuesta en su cach\xe9. Pregunta por la direcci\xf3n ip del nombre ",(0,t.kt)("a",{parentName:"p",href:"http://www.informatica.tunombre.org."},"www.informatica.tunombre.org.")," \xbfQui\xe9n ha respondido?."),(0,t.kt)("p",null,"Si no aparacen en el fichero, ponemos las dos directivas nameserver del servidor DNS maestro y del servidor DNS esclavo en el fichero /etc/resolv.conf del cliente:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-bash"},"nameserver 172.22.5.136\nnameserver 172.22.4.145\n")),(0,t.kt)("h1",{id:"entrega"},"Entrega"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"1.- Una captura de pantalla donde se vea la consulta para averiguar la direcci\xf3n IP de ",(0,t.kt)("a",{parentName:"strong",href:"http://www.informatica.tunombre.org"},"www.informatica.tunombre.org"),".")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"2.- Una captura de pantalla donde se vea la consulta para averiguar el servidor DNS con autoridad para la zona del dominio informatica.tunombre.org. \xbfEs el mismo que el servidor DNS con autoridad para la zona tunombre.org?")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"3.- Una captura de pantalla donde se vea la consulta para averiguar el servidor de correo configurado para informatica.tunombre.org.")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"4.- Realiza el ejercicio que te va a proponer el profesor.")))}m.isMDXComponent=!0}}]);